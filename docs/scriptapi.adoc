= POCA Script API Documentation
:toc:
:toc-placement: preamble
:toclevels: 3
:showtitle:
:!webfonts:

// Need some preamble to get TOC:
{empty}

== Array

=== Overview

The POCA Array API provides functionality similar to JavaScript arrays.
Arrays in POCA are dynamic, typeless collections that support a variety
of operations including element insertion, removal, slicing, sorting,
joining, and filling. The API offers an Array namespace for creating
arrays as well as a rich set of methods on arrays for manipulating 
collections of values.

'''''

=== Global Array Object

The global *Array* object serves as both a factory and a namespace for
array operations. You can create arrays using any of the following 
variants:

==== Array.create(), new Array(), or the [] Literal Syntax

*Usage:*

[source,js]
----
let arr = Array.create();
----

or equivalently,

[source,js]
----
let arr = new Array();
----

or using the literal syntax:

[source,js]
----
let arr = [];
----

You can also provide an initial size and elements:

[source,js]
----
let arr = Array.create(3, "a", "b", "c");
----

or via literal notation (when supported):

[source,js]
----
let arr = ["a", "b", "c"];
----

* *Description:* `+Array.create()+`, `+new Array()+`, or the `+[]+`
literal syntax creates a new array by invoking the underlying array 
creation routine. The resulting ghost object represents a dynamic array, 
which is registered for subsequent array operations.
* *Parameters:*
** If provided, the first parameter specifies the desired size of the
array.
** Additional parameters (if any) are used to initialize the array
elements.
* *Return Value:* A new array.
* *Example:*
+
[source,js]
----
// Create an empty array.
let arr1 = Array.create();
let arr2 = new Array();
let arr3 = []; // Using literal syntax

// Create an array with size 3 and initial values.
let arr4 = Array.create(3, "a", "b", "c");
let arr5 = ["a", "b", "c"]; // Using literal syntax with initial values
----

'''''

=== Methods on Arrays

Once created, arrays provide the following methods:

==== Array.empty

*Usage:*

[source,js]
----
let isEmpty = arr.empty();
----

* *Description:* Returns a numeric boolean value indicating whether the
array is empty (1 if empty, 0 otherwise).
* *Parameters:* None.
* *Return Value:* A numeric boolean value.
* *Example:*
+
[source,js]
----
if (arr.empty()) {
  puts("The array is empty.");
}
----

'''''

==== Array.size

*Usage:*

[source,js]
----
let size = arr.size();
----

* *Description:* Returns the number of elements in the array.
* *Parameters:* None.
* *Return Value:* A numeric value representing the array size.
* *Example:*
+
[source,js]
----
let n = arr.size();
puts("Array size: " + n);
----

'''''

==== Array.resize

*Usage:*

[source,js]
----
arr.resize(newSize);
----

* *Description:* Resizes the array to the specified size. If the new
size is smaller, elements are truncated; if larger, new slots are added
(typically initialized to null).
* *Parameters:*
** `+newSize+` (number): The desired new size of the array.
* *Return Value:* The array itself.
* *Example:*
+
[source,js]
----
arr.resize(10);
----

'''''

==== Array.push

*Usage:*

[source,js]
----
arr.push(element1, element2, ...);
----

* *Description:* Appends one or more elements to the end of the array.
* *Parameters:* One or more elements to be added.
* *Return Value:* The array itself.
* *Example:*
+
[source,js]
----
arr.push("new item");
----

'''''

==== Array.pop

*Usage:*

[source,js]
----
let item = arr.pop();
----

* *Description:* Removes and returns the last element from the array.
* *Parameters:* None.
* *Return Value:* The removed element.
* *Example:*
+
[source,js]
----
let last = arr.pop();
----

'''''

==== Array.slice

*Usage:*

[source,js]
----
let subArray = arr.slice(start, length);
----

* *Description:* Returns a new array containing a portion of the
original array, starting at the specified index and extending for the
specified length. If the length is omitted or exceeds the remaining
elements, the slice extends to the end of the array.
* *Parameters:*
** `+start+` (number): The starting index.
** `+length+` (number): The number of elements to include (optional).
* *Return Value:* A new array containing the specified elements.
* *Example:*
+
[source,js]
----
let part = arr.slice(2, 3);
----

'''''

==== Array.splice

*Usage:*
[source,js]
----
arr.splice(start, deleteCount, item1, item2, ...);
----

* *Description:* Modifies the array by removing or replacing existing
elements and/or adding new elements in place. The `+start+` parameter
specifies the index at which to start modifying the array, and
`+deleteCount+` specifies how many elements to remove. If `+deleteCount+`
is omitted, all elements from `+start+` to the end of the array are
removed. You can also add new elements by providing additional
arguments after `+deleteCount+`.
* *Parameters:*
** `+start+` (number): The index at which to start modifying the array.
** `+deleteCount+` (number, optional): The number of elements to remove.
** `+item1, item2, ...+` (any, optional): The elements to add.
* *Return Value:* The removed elements (if any).
* *Example:*
+
[source,js]
----
arr.splice(2, 1, "new item");
----

'''''

==== Array.toSpliced

*Usage:*
[source,js]
----
let newArr = arr.toSpliced(start, deleteCount, item1, item2, ...);
----

* *Description:* Returns a new array with the specified elements
removed and/or replaced, without modifying the original array. The
`+start+` parameter specifies the index at which to start modifying the
array, and `+deleteCount+` specifies how many elements to remove. If
`+deleteCount+` is omitted, all elements from `+start+` to the end of the
array are removed. You can also add new elements by providing
additional arguments after `+deleteCount+`.
* *Parameters:*
** `+start+` (number): The index at which to start modifying the array.
** `+deleteCount+` (number, optional): The number of elements to remove.
** `+item1, item2, ...+` (any, optional): The elements to add.
* *Return Value:* A new array with the specified elements removed and/or
added.
* *Example:*
+
[source,js]
----
let newArr = arr.toSpliced(2, 1, "new item");
----

'''''

==== Array.sort

*Usage:*

[source,js]
----
arr.sort();
----

* *Description:* Sorts the array elements in place using the default
comparison.
* *Parameters:* None.
* *Return Value:* The sorted array itself.
* *Example:*
+
[source,js]
----
arr.sort();
----

'''''

==== Array.toSorted

*Usage:*
[source,js]
----
let sortedArray = arr.toSorted();
----

* *Description:* Returns a new array with the elements sorted, without
modifying the original array.
* *Parameters:* None.
* *Return Value:* A new array with the elements sorted.
* *Example:*
+
[source,js]
----
let sortedArr = arr.toSorted();
puts("Sorted array: ", String.dump(sortedArr));
----

'''''

==== Array.join

*Usage:*

[source,js]
----
let str = arr.join(separator);
----

* *Description:* Joins all elements of the array into a single string,
separated by the specified separator. If no separator is provided, a
comma is used by default.
* *Parameters:*
** `+separator+` (string): The string to insert between each element
(optional).
* *Return Value:* A string resulting from concatenating the array
elements.
* *Example:*
+
[source,js]
----
let result = arr.join("-");
----

'''''

==== Array.fill

*Usage:*

[source,js]
----
arr.fill(value, start, end);
----

* *Description:* Replaces a range of elements in the array with the
specified value. The filling starts at the index specified by `+start+`
and ends just before the index specified by `+end+`. If `+start+` is
omitted, it defaults to 0; if `+end+` is omitted, it defaults to the
array size.
* *Parameters:*
** `+value+` (any): The value to fill with.
** `+start+` (number, optional): The starting index.
** `+end+` (number, optional): The ending index.
* *Return Value:* The array itself.
* *Example:*
+
[source,js]
----
arr.fill("x", 2, 5);
----

'''''

==== Array.toFilled

*Usage:*

[source,js]
----
arr.toFilled(value, start, end);
----

* *Description:* Replaces a range of elements in the array with the
specified value. The filling starts at the index specified by `+start+`
and ends just before the index specified by `+end+`. If `+start+` is
omitted, it defaults to 0; if `+end+` is omitted, it defaults to the
array size.
* *Parameters:*
** `+value+` (any): The value to fill with.
** `+start+` (number, optional): The starting index.
** `+end+` (number, optional): The ending index.
* *Return Value:* A new array with the specified range filled.
* *Example:*
+
[source,js]
----
let newArr = arr.toFilled("x", 2, 5);
----

'''''

==== Array.delete

*Usage:*
[source,js]
----
arr.delete(index...);
----

* *Description:* Deletes the element at the specified index/indices from 
the array. The array is resized accordingly.
* *Parameters:*
** `+index+` (number): The index/indices of the element to delete.
* *Return Value:* The array itself.
* *Example:*
+
[source,js]
----
arr.delete(2);
----

'''''

==== Array.remove

*Usage:*
[source,js]
----
arr.remove(element...);
----

* *Description:* Removes all occurrences of the specified element(s)
from the array.
* *Parameters:*
** `+element+` (any): The element(s) to remove.
* *Return Value:* The array itself.
* *Example:*
+
[source,js]
----
arr.remove("x");
----

'''''

==== Array.indexOf

*Usage:*
[source,js]
----
let index = arr.indexOf(element);
----

* *Description:* Returns the index of the first occurrence of the
specified element in the array. If the element is not found, it
returns -1.
* *Parameters:*
** `+element+` (any): The element to search for.
* *Return Value:* The index of the element, or -1 if not found.
* *Example:*
+
[source,js]
----
let idx = arr.indexOf("x");
if (idx !== -1) {
  puts("Element found at index: " + idx);
} else {
  puts("Element not found.");
}
----

'''''

==== Array.lastIndexOf

*Usage:*
[source,js]
----
let index = arr.lastIndexOf(element);
----

* *Description:* Returns the index of the last occurrence of the
specified element in the array. If the element is not found, it
returns -1.
* *Parameters:*
** `+element+` (any): The element to search for.
* *Return Value:* The index of the element, or -1 if not found.
* *Example:*
+
[source,js]
----
let idx = arr.lastIndexOf("x");
if (idx !== -1) {
  puts("Element found at index: " + idx);
} else {
  puts("Element not found.");
}
----

'''''

==== Array.reverse

*Usage:*
[source,js]
----
arr.reverse();
----

* *Description:* Reverses the order of the elements in the array.
* *Parameters:* None.
* *Return Value:* The reversed array itself.
* *Example:*
+
[source,js]
----
arr.reverse();
----

'''''

==== Array.toReversed

*Usage:*
[source,js]
----
let reversedArray = arr.toReversed();
----

* *Description:* Returns a new array with the elements in reverse
order, without modifying the original array.
* *Parameters:* None.
* *Return Value:* A new array with the elements in reverse order.
* *Example:*
+
[source,js]
----
let reversed = arr.toReversed();
puts("Reversed array: ", String.dump(reversed));
----

'''''

==== Array.includes

*Usage:*
[source,js]
----
let exists = arr.includes(element);
----

* *Description:* Checks if the specified element exists in the array.
* *Parameters:*
** `+element+` (any): The element to check for.
* *Return Value:* A numeric boolean (1 for true, 0 for false).
* *Example:*
+
[source,js]
----
if (arr.includes("x")) {
  puts("Element exists in the array.");
} else {
  puts("Element does not exist.");
}
----

'''''

==== Array.shift

*Usage:*
[source,js]
----
let firstElement = arr.shift();
----

* *Description:* Removes and returns the first element from the array.
* *Parameters:* None.
* *Return Value:* The removed element.
* *Example:*
+
[source,js]
----
let first = arr.shift();
puts("First element removed: ", first);
----

'''''

==== Array.unshift

*Usage:*
[source,js]
----
arr.unshift(element1, element2, ...);
----

* *Description:* Adds one or more elements to the beginning of the
array.
* *Parameters:* One or more elements to be added.
* *Return Value:* The array itself.
* *Example:*
+
[source,js]
----
arr.unshift("new item");
----

'''''

=== Summary

* *Global Object:* The Array object acts as a factory for creating array
ghost objects. `+Array.create()+`, `+new Array()+`, or the `+[]+`
literal syntax creates a new array by invoking the underlying array 
creation routine. The resulting ghost object represents a dynamic array, 
which is registered for subsequent array operations.
* *Array Methods:* Once created, array provide the following methods to 
manipulate arrays:
** *empty:* Returns a numeric boolean indicating whether the array is
empty.
** *size:* Returns the number of elements in the array.
** *resize:* Changes the size of the array.
** *push:* Appends one or more elements to the end of the array.
** *pop:* Removes and returns the last element of the array.
** *slice:* Extracts a portion of the array into a new array.
** *sort:* Sorts the array elements.
** *join:* Concatenates array elements into a string, separated by a
specified separator.
** *fill:* Replaces a range of elements in the array with a specified
value.
* *Usage:* Arrays in POCA function similarly to JavaScript arrays,
offering dynamic resizing and a rich set of operations for manipulating
collections of values. This comprehensive API lets you incorporate
robust array handling into your POCA projects, providing flexible and
powerful data manipulation capabilities.

== Boolean

=== Overview

The POCA Boolean API provides a mechanism for converting values into a
boolean representation. In POCA, booleans are represented as number
literals—0 for false and 1 for true. The global Boolean object acts as a
factory for creating these boolean values.

'''''

=== Global Boolean Object

The global *Boolean* object serves as a factory for boolean values.

==== Boolean.create

*Usage:*

[source,js]
----
let b = Boolean.create(someValue);
----

* *Description:* `+Boolean.create()+` converts the provided value into a
boolean number. If an argument is provided, it returns 1 (true) if the
value is truthy, or 0 (false) otherwise. If no argument is provided, it
returns 0 (false).
* *Parameters:*
** `+value+` (any, optional): The value to convert to a boolean.
* *Return Value:* A number literal representing the boolean value (0 or
1).
* *Example:*
+
[source,js]
----
let b1 = Boolean.create(0);   // Returns 0 (false)
let b2 = Boolean.create(42);  // Returns 1 (true)
let b3 = Boolean.create();    // Returns 0 (false)
----

'''''

=== Summary

* *Global Object:* The Boolean object acts as a factory for creating
boolean values. `+Boolean.create()+` converts a provided value into a
number literal (0 or 1) representing false or true.
* *Boolean API Function:*
** *create:* Converts a value to a boolean; if no value is provided, it
returns 0 (false).
* *Usage:* This API enables you to convert any value to its boolean
representation in POCA, using the familiar paradigm where 0 represents
false and 1 represents true.

== Console

=== Overview

The POCA Console API provides basic input/output functions for
interacting with the console in POCA scripts. With this API, you can log
messages to the console and read user input from it. The API uses
user-provided I/O functions (if available) for writing and flushing
output, falling back to system I/O routines otherwise.

'''''

=== Global Console Object

The global *Console* object serves as a namespace for console
operations. It includes functions to log output and to read a line of
input from the console.

'''''

==== Console.log

*Usage:*

[source,js]
----
Console.log(value1, value2, ...);
----

* *Description:* The `+Console.log+` function outputs one or more values
to the console. For each argument, it converts the value to a string:
** If the value is `+null+`, it outputs `+"null"+`.
** If the value is a string, it converts the internal UTF‑8
representation to UTF‑16 before writing, when it is necessary for
the underlying I/O function, otherwise it writes the UTF‑8 string
directly.
** If the value is a number, it converts the number to its string
representation.
+
After processing all arguments, `+Console.log+` writes a newline and
flushes the output (using user-defined I/O functions if available, or
the system I/O routines otherwise).
* *Parameters:*
** One or more values (of type `+null+`, string, or number) to be
logged.
* *Return Value:* A `+null+` value (represented internally as a number
literal with the special null value).
* *Example:*
+
[source,js]
----
// Log different types of values.
Console.log("Hello, World!", 123.45, null);
----

'''''

==== Console.readLine

*Usage:*

[source,js]
----
let input = Console.readLine(prompt);
----

* *Description:* The `+Console.readLine+` function reads a full line of
text from the console. An optional prompt can be provided, which is
passed to the underlying input function.
* *Parameters:*
** _prompt_ (string, optional): A string displayed to the user as a
prompt before reading input.
* *Return Value:* A string containing the line read from the console.
* *Example:*
+
[source,js]
----
// Read user input with a prompt.
let userInput = Console.readLine("Enter your name: ");
Console.log("Hello, " + userInput + "!");
----

'''''

=== Summary

* *Global Object:* The Console object provides a namespace for basic
console operations. It offers functions to log messages and read input
from the console.
* *Console API Functions:*
** *log:* Outputs one or more values to the console. Values are
converted to strings (with special handling for `+null+`, strings, and
numbers), followed by a newline and a flush of the output.
** *readLine:* Reads a line of text from the console, optionally
displaying a prompt.
* *Usage:* This comprehensive API enables you to output messages and
interact with the user via the console, using either user-defined or
system I/O routines in a dynamic, typeless environment.

== Coroutine

=== Overview

The POCA Coroutine API enables cooperative multitasking in your POCA
scripts. Coroutines in POCA are dynamic, typeless ghost objects that
encapsulate a separate execution context. You can create a coroutine to
run a function concurrently (in a cooperative manner) and later resume
its execution, yield control, or retrieve passed values. The API
provides a set of functions to create, resume, yield, and retrieve
values from a coroutine.

'''''

=== Global Coroutine Object

The global *Coroutine* object serves as a namespace and factory for
coroutine operations. It provides functions to create a new coroutine,
yield execution from within a coroutine, and retrieve the latest value
passed to it. In addition, coroutine ghost objects have a dedicated
method (`+resume+`) registered in the global coroutine hash that lets
you resume a suspended coroutine.

'''''

=== Creating a Coroutine

==== Coroutine.create

*Usage:*

[source,js]
----
let co = Coroutine.create(function(a, b) {
  // Coroutine body: perform operations using a and b.
  puts("Inside coroutine, received: " + a + ", " + b);

  // Yield a value back to the caller.
  Coroutine.yield("Yielding from coroutine");

  // When resumed, get the new input:
  let resumedValue = Coroutine.get();
  puts("Resumed with: " + resumedValue);

  return "Coroutine complete";
}, arg1, arg2);
----

or
[source,js]
----
let co = new Coroutine(function(a, b) {
  // Coroutine body: perform operations using a and b.
  puts("Inside coroutine, received: " + a + ", " + b);

  // Yield a value back to the caller.
  Coroutine.yield("Yielding from coroutine");

  // When resumed, get the new input:
  let resumedValue = Coroutine.get();
  puts("Resumed with: " + resumedValue);

  return "Coroutine complete";
}, arg1, arg2);
----

* *Description:* `+Coroutine.create+` or `+new Coroutine+` creates 
a coroutine ghost object with the provided function. The first argument 
must be a function, and any additional arguments will be passed to that 
function when the coroutine is first executed. Internally, a new 
execution context is created for the coroutine, and the coroutine ghost 
object is registered in the global coroutine hash.
* *Parameters:*
** `+func+` (function): The function to be executed as a coroutine.
** `+...args+` (any): Additional arguments that are passed to the
coroutine function.
* *Return Value:* A coroutine ghost object that encapsulates the created
coroutine.
* *Example:*
+
[source,js]
----
// Create a coroutine that accepts two arguments.
let co = Coroutine.create(function(a, b) {
  puts("Started with: " + a + ", " + b);
  // Suspend execution, yielding a value.
  Coroutine.yield("Paused");
  // Retrieve the value passed on resume.
  let input = Coroutine.get();
  puts("Resumed with: " + input);
  return "Done";
}, "first", "second");
----

or

[source,js]
----
// Create a coroutine that accepts two arguments.
let co = new Coroutine(function(a, b) {
  puts("Started with: " + a + ", " + b);
  // Suspend execution, yielding a value.
  Coroutine.yield("Paused");
  // Retrieve the value passed on resume.
  let input = Coroutine.get();
  puts("Resumed with: " + input);
  return "Done";
}, "first", "second");
----
* *Note:* The coroutine function can be defined inline or as a named
function.

'''''

=== Resuming a Coroutine

==== coroutine.resume

*Usage:*

[source,js]
----
let result = coroutine.resume(value);
----

* *Description:* Resumes the execution of a previously created
coroutine. Optionally, you can pass a value to the coroutine that will
be accessible after it yields. If the coroutine function throws an
exception, it is re-raised when you resume it.
* *Parameters:*
** `+value+` (any): A value passed to the coroutine to resume its
execution. If omitted, a null value is used.
* *Return Value:* The value yielded by the coroutine immediately before
suspension, or the final return value if the coroutine completes.
* *Example:*
+
[source,js]
----
// Resume the coroutine, passing "continue" as the resume value.
let output = coroutine.resume("continue");
puts("Coroutine yielded: " + output);
----

'''''

=== Yielding from a Coroutine

==== Coroutine.yield

*Usage:*

[source,js]
----
Coroutine.yield(value);
----

* *Description:* From within a coroutine function, use
`+Coroutine.yield+` to suspend its execution and optionally return a
value to the caller. Execution will pause at this point until the
coroutine is resumed.
* *Parameters:*
** `+value+` (any): A value to be yielded back to the caller. If
omitted, a null value is used.
* *Return Value:* No value is returned by `+Coroutine.yield+` directly;
instead, the coroutine’s state is saved and later resumed.
* *Example:*
+
[source,js]
----
// Inside the coroutine function:
Coroutine.yield("Yielding control");
// Execution pauses here until resumed.
----

'''''

=== Retrieving a Resume Value

==== Coroutine.get

*Usage:*

[source,js]
----
let value = Coroutine.get();
----

* *Description:* When a coroutine is resumed, the value passed to
`+resume+` is stored. You can retrieve this value inside the coroutine
by calling `+Coroutine.get+`.
* *Parameters:* None.
* *Return Value:* The value that was passed to the coroutine during the
last `+resume+` call, or a null value if none was provided.
* *Example:*
+
[source,js]
----
// Inside the coroutine function after yielding:
let resumeValue = Coroutine.get();
puts("Received on resume: " + resumeValue);
----

'''''

=== Coroutine Additional Instance Methods

A coroutine is a ghost object that have the following API methods:

==== Coroutine.resumed

*Usage:*
[source,js]
----
let isResumed = coroutine.resumed();
----

* *Description:* Checks if the coroutine has been resumed. This
indicates that the coroutine is already at least once resumed and is
currently executing or suspended.
* *Parameters:* None.
* *Return Value:* A numeric boolean (1 for true, 0 for false).
* *Example:*
+
[source,js]
----
let isResumed = coroutine.resumed();
if (isResumed) {
  puts("Coroutine has been resumed.");
} else {
  puts("Coroutine has not been resumed yet.");
}
----

'''''

==== Coroutine.data

*Usage:*
[source,js]
----
let data = coroutine.data();
----

* *Description:* Returns the data hash associated with the coroutine. 
This is the value passed to the coroutine when it was created. If no data
is associated with the coroutine, it returns a empty hash. In the
coroutine function, you can access this data using `this`.
* *Parameters:* None.
* *Return Value:* A hash containing the data associated with the
coroutine.
* *Example:*
+
[source,js]
----
let data = coroutine.data();
puts("Coroutine data: ", String.dump(data));
----

'''''

==== Coroutine.state

*Usage:*
[source,js]
----
let state = coroutine.state();
----

* *Description:* Returns the current state of the coroutine. The state
can be one of the following:
** `none`: The coroutine has not been started yet.
** `outside`: The coroutine is currently outside of its execution context.
** `inside`: The coroutine is currently inside its execution context.
** `insideterminated`: The coroutine is inside its execution context and
 is terminated.
** `terminated`: The coroutine has been terminated.
* *Parameters:* None.
* *Return Value:* A string representing the current state of the
coroutine.
* *Example:*
+
[source,js]
----
let state = coroutine.state();
puts("Coroutine state: ", state);
----

'''''

==== Coroutine.inside

*Usage:*
[source,js]
----
let isInside = coroutine.inside();
----

* *Description:* Checks if the coroutine is currently inside its
execution context. This is useful for determining if the coroutine is
actively executing or has been suspended.
* *Parameters:* None.
* *Return Value:* A numeric boolean (1 for true, 0 for false).
* *Example:*
+
[source,js]
----
let isInside = coroutine.inside();
if (isInside) {
  puts("Coroutine is currently executing.");
} else {
  puts("Coroutine is not executing.");
}
----

'''''

==== Coroutine.outside

*Usage:*
[source,js]
----
let isOutside = coroutine.outside();
----

* *Description:* Checks if the coroutine is currently outside its
execution context. This is useful for determining if the coroutine is
suspended or has completed its execution.
* *Parameters:* None.
* *Return Value:* A numeric boolean (1 for true, 0 for false).
* *Example:*
+
[source,js]
----
let isOutside = coroutine.outside();
if (isOutside) {
  puts("Coroutine is currently suspended.");
} else {
  puts("Coroutine is executing.");
}
----

'''''

==== Coroutine.terminated

*Usage:*
[source,js]
----
let isTerminated = coroutine.terminated();
----

* *Description:* Checks if the coroutine has been terminated. This
indicates that the coroutine has completed its execution and is no
longer active.
* *Parameters:* None.
* *Return Value:* A numeric boolean (1 for true, 0 for false).
* *Example:*
+
[source,js]
----
let isTerminated = coroutine.terminated();
if (isTerminated) {
  puts("Coroutine has been terminated.");
} else {
  puts("Coroutine is still active.");
}
----

'''''

==== Coroutine.alive

*Usage:*
[source,js]
----
let isAlive = coroutine.alive();
----

* *Description:* Checks if the coroutine is alive. This indicates that
the coroutine is still active and has not been terminated.
* *Parameters:* None.
* *Return Value:* A numeric boolean (1 for true, 0 for false).
* *Example:*
+
[source,js]
----
let isAlive = coroutine.alive();
if (isAlive) {
  puts("Coroutine is alive.");
} else {
  puts("Coroutine has been terminated.");
}
----
'''''

=== Coroutine Lifecycle and Resource Management

When a coroutine finishes execution or is destroyed: - Its internal
execution context and allocated resources are properly cleaned up. - If
an exception occurs during execution, it is captured and re-raised when
the coroutine is resumed. - The garbage collector is informed of all
associated values (arguments, context, and function) via the ghost
object’s mark procedure.

The API ensures that any associated coroutine data is finalized and
memory is released when the coroutine ghost is destroyed.

'''''

=== Example Usage

[source,js]
----
// Create a coroutine that processes some data.
let co = Coroutine.create(function(x, y) {
  puts("Coroutine started with: " + x + " and " + y);

  // Suspend execution and yield a status.
  Coroutine.yield("Waiting for resume...");

  // Retrieve the resume value.
  let resumeData = Coroutine.get();
  puts("Resumed with: " + resumeData);

  // Continue processing and complete.
  return "Processing complete";
}, "data1", "data2");

// Resume the coroutine, passing a value.
let initialYield = co.resume("resume_value_1");
puts("Yielded value: " + initialYield);

// Resume again to complete the coroutine.
let finalResult = co.resume("resume_value_2");
puts("Final result: " + finalResult);
----

'''''

=== Summary

* *Global Object:* The *Coroutine* object provides the following
functions:
** *create:* Creates a coroutine ghost object for a provided function.
** *yield:* Suspends the execution of a running coroutine, optionally
yielding a value.
** *get:* Retrieves the value passed to the coroutine when it is
resumed.
* *Coroutine Ghost Object Methods:* Once created, a coroutine ghost
object supports the *resume* method (registered in the global Coroutine
hash), which resumes its execution and returns the value yielded by the
coroutine.
* *Lifecycle:* The API manages the coroutine’s context, arguments, and
exception handling, ensuring proper resource cleanup when the coroutine
is destroyed.

This comprehensive API enables you to implement cooperative multitasking
in POCA, making it possible to write asynchronous or concurrent code in
a dynamic, typeless environment.

== DateTime

=== Overview

The POCA DateTime API provides functions for working with date and time
values in POCA scripts. Date and time values are represented in the
TDateTime format—a 64-bit double floating point number—similar to
FreePascal and Delphi, where the fractional part represents the time of
day. With this API, you can retrieve the current date and time in both
local and UTC formats, and convert date/time values to milliseconds.

'''''

=== Global DateTime Object

The global *DateTime* object serves as a namespace for date and time
operations. It provides the following functions:

==== DateTime.now

*Usage:*

[source,js]
----
let currentTime = DateTime.now();
----

* *Description:* Returns the current local date and time as a TDateTime
value (a 64-bit double). The TDateTime format represents the number of
days (including fractions for time) since a base date.
* *Parameters:* None.
* *Return Value:* A numeric value in TDateTime format representing the
current local date and time.
* *Example:*
+
[source,js]
----
let now = DateTime.now();
puts("Current local time: " + now);
----

'''''

==== DateTime.nowUTC

*Usage:*

[source,js]
----
let currentUTCTime = DateTime.nowUTC();
----

* *Description:* Returns the current UTC date and time as a TDateTime
value (a 64-bit double). The TDateTime format is used consistently for
both local and UTC times.
* *Parameters:* None.
* *Return Value:* A numeric value in TDateTime format representing the
current UTC date and time.
* *Example:*
+
[source,js]
----
let utcNow = DateTime.nowUTC();
puts("Current UTC time: " + utcNow);
----

'''''

==== DateTime.milliseconds

*Usage:*

[source,js]
----
let ms = DateTime.milliseconds(timeValue);
----

* *Description:* Converts a date time value (representing days) into
milliseconds. Since one day equals 86,400,000 milliseconds, the function
multiplies the input value by 86,400,000.
* *Parameters:*
** `+timeValue+` (number): A date time value (in days) to be converted
to milliseconds.
* *Return Value:* A numeric value representing the equivalent time in
milliseconds.
* *Example:*
+
[source,js]
----
// Convert current time (in days) to milliseconds.
let ms = DateTime.milliseconds(DateTime.now());
puts("Milliseconds since base date: " + ms);
----

'''''

==== DateTime.utcOffset

*Usage:*
[source,js]
----
let offset = DateTime.utcOffset(dateTimeValue);
----

* *Description:* Returns the UTC offset in hours for the current local
time zone. This is useful for converting between local and UTC times.
* *Parameters:*
** `+dateTimeValue+` (number, optional): A TDateTime value (in days) 
for which to calculate the UTC offset. If omitted, the current
date/time is used.
* *Return Value:* A numeric value representing the UTC offset.
* *Example:*
+
[source,js]
----
// Get the UTC offset for the current local time.
let offset = DateTime.utcOffset(DateTime.now());
puts("UTC offset: " + offset);
----

'''''

==== DateTime.toLocal

*Usage:*
[source,js]
----
let localTime = DateTime.toLocal(dateTimeValue);
----

* *Description:* Converts a date time value (in days) to the local time
format. This is useful for displaying date/time values in the local
time zone.
* *Parameters:*
** `+dateTimeValue+` (number): A date time value (in days) to be 
converted to local time.
* *Return Value:* A numeric value representing the local time in
date time format.
* *Example:*
+
[source,js]
----
// Convert a UTC date/time value to local time.
let utcTime = DateTime.nowUTC();
let localTime = DateTime.toLocal(utcTime);
puts("Local time: " + localTime);
----

'''''
==== DateTime.toUniversal
*Usage:*
[source,js]
----
let utcTime = DateTime.toUniversal(dateTimeValue);
----
* *Description:* Converts a date time value (in days) to the UTC time
format. This is useful for displaying date/time values in UTC.
* *Parameters:*
** `+dateTimeValue+` (number): A date time value (in days) to be
converted to UTC time.
* *Return Value:* A numeric value representing the UTC time in date
time format.
* *Example:*
+
[source,js]
----
// Convert a local date/time value to UTC.
let localTime = DateTime.now();
let utcTime = DateTime.toUniversal(localTime);
puts("UTC time: " + utcTime);
----

'''''

==== DateTime.fromUnixTime

*Usage:*
[source,js]
----
let dateTimeValue = DateTime.fromUnixTime(unixTime);
----

* *Description:* Converts a Unix timestamp (seconds since the epoch)
to a date time value (in days). The Unix timestamp is typically
represented as a 32-bit integer, and this function converts it to
a date time value.
* *Parameters:*
** `+unixTime+` (number): A Unix timestamp (seconds since the epoch)
* *Return Value:* A numeric value representing the date time in
date time format.
* *Example:*
+
[source,js]
----
// Convert a Unix timestamp to a date/time value.
let unixTime = 1633072800; // Example Unix timestamp
let dateTimeValue = DateTime.fromUnixTime(unixTime);
puts("Date/time value: ", dateTimeValue);
----

'''''

==== DateTime.toUnixTime

*Usage:*
[source,js]
----
let unixTime = DateTime.toUnixTime(dateTimeValue);
----

* *Description:* Converts a date time value (in days) to a Unix
timestamp (seconds since the epoch). This is useful for
interoperating with systems that use Unix timestamps.
* *Parameters:*
** `+dateTimeValue+` (number): A date time value (in days) to be
converted to a Unix timestamp.
* *Return Value:* A numeric value representing the Unix timestamp.
* *Example:*
+
[source,js]
----
// Convert a date/time value to a Unix timestamp.
let dateTimeValue = DateTime.now();
let unixTime = DateTime.toUnixTime(dateTimeValue);
puts("Unix timestamp: ", unixTime);
----

'''''

==== DateTime.toString

*Usage:*
[source,js]
----
let dateTimeString = DateTime.toString(dateTimeValue, format);
----

* *Description:* Converts a date time value (in days) to a string
representation. The format string specifies how the date and time
should be displayed. The format string can include various placeholders
for year, month, day, hour, minute, second, etc.
* *Parameters:*
** `+dateTimeValue+` (number): A date time value (in days) to be
converted to a string.
** `+format+` (string, optional): A format string that specifies how 
the date and time should be displayed. Placeholders in the format 
string are replaced with the corresponding date/time components. If
omitted, a default format is used.
* *Return Value:* A string representing the date and time in the
specified format.
* *Example:*
+
[source,js]
----
// Convert a date/time value to a string with the default format.
let dateTimeValue = DateTime.now();
let formattedString = DateTime.toString(dateTimeValue);
puts("Formatted date/time: ", formattedString);
----

'''''

==== DateTime.parse

*Usage:*
[source,js]
----
let dateTimeValue = DateTime.parse(dateTimeString);
----

* *Description:* Parses a date time string and converts it to a date
time value (in days). The input string should be in a recognized date
time format. The function attempts to parse the string and return a
date time value. If the string cannot be parsed, an error is raised.
* *Parameters:*
** `+dateTimeString+` (string): A string representing a date and time
to be parsed.
* *Return Value:* A numeric value representing the parsed date and
time in date time format.
* *Example:*
+
[source,js]
----
// Parse a date/time string and convert it to a date time value.
let dateTimeString = "2023-10-01 12:34:56";
let dateTimeValue = DateTime.parse(dateTimeString);
puts("Parsed date/time value: ", dateTimeValue);
----

'''''

=== Summary

* *Global Object:* The DateTime object provides functions to work with
date and time values in POCA scripts. These functions return values in
the TDateTime format—a 64-bit double where the fractional part
represents the time of day.
* *DateTime Functions:*
** *now:* Returns the current local date and time.
** *nowUTC:* Returns the current UTC date and time.
** *milliseconds:* Converts a TDateTime value (in days) to milliseconds.
** *utcOffset:* Returns the UTC offset in hours for the current local
time zone.
** *toLocal:* Converts a TDateTime value (in days) to local time.
** *toUniversal:* Converts a TDateTime value (in days) to UTC time.
** *toString:* Converts a TDateTime value (in days) to a string
representation, using a specified format string.
** *parse:* Parses a date time string and converts it to a TDateTime
* *Usage:* This comprehensive API allows you to integrate date and time
operations into your POCA projects, providing a consistent and familiar
approach to handling TDateTime values as used in FreePascal and Delphi.
* *Note:* The TDateTime format is compatible with FreePascal and Delphi,
allowing for easy integration with existing codebases and libraries.

== GarbageCollector

=== Overview

In POCA, garbage collection is a incremental generational system that
manages memory and lifecycle for dynamically allocated objects (e.g.,
arrays, strings, hash tables, code objects, etc.). The
*GarbageCollector* object provides direct access to certain GC
parameters (like tuning factors for how aggressively GC runs) and lets
you manually trigger collection events if desired. This API is exposed
under the global *GarbageCollector* namespace.

'''''

=== GarbageCollector Object

The global *GarbageCollector* object is a namespace for
garbage-collection operations and configuration. It holds functions to
get or set GC tuning parameters, run GC cycles or full collections, and
query memory usage information.

'''''

=== Getting Parameters

These functions read the current settings from the garbage collector:

==== GarbageCollector.getStepFactor

*Usage:*

[source,js]
----
let factor = GarbageCollector.getStepFactor();
----

* *Description:* Returns the "`step factor`" used to decide how many
objects to mark or sweep in a partial/stepped collection cycle
(triggered by `+GarbageCollector.cycle+`).
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getIntervalFactor

*Usage:*

[source,js]
----
let factor = GarbageCollector.getIntervalFactor();
----

* *Description:* Returns the "`interval factor`" that controls how many
cycles elapse before persistent objects are reconsidered.
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getGhostFactor

*Usage:*

[source,js]
----
let factor = GarbageCollector.getGhostFactor();
----

* *Description:* Returns the "`ghost factor`" used to determine how
aggressively ghost objects (special objects like IO streams, threads,
coroutines, etc.) are processed.
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getSweepFactor

*Usage:*

[source,js]
----
let factor = GarbageCollector.getSweepFactor();
----

* *Description:* Returns the "`sweep factor`" controlling how many
objects are swept (freed) in each partial sweep step.
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getPersistentInterval

*Usage:*

[source,js]
----
let interval = GarbageCollector.getPersistentInterval();
----

* *Description:* Returns the number of cycles after which persistent
objects (long-lived objects) are rescanned.
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getPersistentThreshold

*Usage:*

[source,js]
----
let threshold = GarbageCollector.getPersistentThreshold();
----

* *Description:* Returns the threshold at which an object transitions
from ephemeral to persistent generation, i.e. how many times an object
can survive GC before it is considered "`persistent.`"
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getFullCollect

*Usage:*

[source,js]
----
let full = GarbageCollector.getFullCollect();
----

* *Description:* Returns whether a full collection (ephemeral plus
persistent) is performed (`+1+` for true, `+0+` for false).
* *Return Value:* A numeric boolean (1 or 0).

'''''

==== GarbageCollector.getIncremental

*Usage:*
[source,js]
----
let incremental = GarbageCollector.getIncremental();
----

* *Description:* Returns whether incremental garbage collection is
enabled (`+1+` for true, `+0+` for false). This is a global setting
that affects all collections.
* *Return Value:* A numeric boolean (1 or 0).
* *Example:*
+
[source,js]
----
// Check if incremental garbage collection is enabled.
let isIncremental = GarbageCollector.getIncremental();
if (isIncremental) {
  puts("Incremental garbage collection is enabled.");
} else {
  puts("Incremental garbage collection is disabled.");
}
----

'''''

==== GarbageCollector.getGenerational

*Usage:*
[source,js]
----
let generational = GarbageCollector.getGenerational();
----

* *Description:* Returns whether generational garbage collection is
enabled (`+1+` for true, `+0+` for false). This is a global setting
that affects all collections.
* *Return Value:* A numeric boolean (1 or 0).
* *Example:*
+
[source,js]
----
// Check if generational garbage collection is enabled.
let isGenerational = GarbageCollector.getGenerational();
if (isGenerational) {
  puts("Generational garbage collection is enabled.");
} else {
  puts("Generational garbage collection is disabled.");
}
----

'''''

==== GarbageCollector.getLocalContextPoolSize

*Usage:*

[source,js]
----
let size = GarbageCollector.getLocalContextPoolSize();
----

* *Description:* Returns the size of the local context pool, which is
used for caching and reuse of temporary contexts.
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getContextCacheSize

*Usage:*

[source,js]
----
let size = GarbageCollector.getContextCacheSize();
----

* *Description:* Returns the size of the context cache that can be
reused to avoid allocations of large stack frames.
* *Return Value:* A numeric value (integer).

'''''

==== GarbageCollector.getMinimumBlockSize

*Usage:*

[source,js]
----
let size = GarbageCollector.getMinimumBlockSize();
----

* *Description:* Returns the minimum block size (in number of objects)
used for new allocation blocks in the memory pool.
* *Return Value:* A numeric value (integer).

'''''

=== Setting Parameters

These functions set the current tuning parameters in the garbage
collector. Each function returns the old value as a number.

==== GarbageCollector.setStepFactor

*Usage:*

[source,js]
----
let old = GarbageCollector.setStepFactor(300);
----

* *Description:* Sets the "`step factor`". During incremental GC cycles,
this factor helps determine how many objects to handle in each GC step.
* *Parameters:*
** _newStepFactor_ (number): The new step factor.
* *Return Value:* The old step factor.

'''''

==== GarbageCollector.setIntervalFactor

*Usage:*

[source,js]
----
let old = GarbageCollector.setIntervalFactor(128);
----

* *Description:* Sets the "`interval factor,`" which affects the rate at
which persistent objects are reconsidered.
* *Parameters:*
** _newIntervalFactor_ (number): The new interval factor.
* *Return Value:* The old interval factor.

'''''

==== GarbageCollector.setGhostFactor

*Usage:*

[source,js]
----
let old = GarbageCollector.setGhostFactor(512);
----

* *Description:* Sets the factor for partial marking/sweeping of ghost
objects.
* *Parameters:*
** _newGhostFactor_ (number)
* *Return Value:* The old ghost factor.

'''''

==== GarbageCollector.setSweepFactor

*Usage:*

[source,js]
----
let old = GarbageCollector.setSweepFactor(400);
----

* *Description:* Sets how aggressively objects are swept (freed) per
cycle.
* *Parameters:*
** _newSweepFactor_ (number)
* *Return Value:* The old sweep factor.

'''''

==== GarbageCollector.setPersistentInterval

*Usage:*

[source,js]
----
let old = GarbageCollector.setPersistentInterval(10);
----

* *Description:* Sets how often (in cycles) persistent objects are
rescanned.
* *Parameters:*
** _newPersistentInterval_ (number)
* *Return Value:* The old interval value.

'''''

==== GarbageCollector.setPersistentThreshold

*Usage:*

[source,js]
----
let old = GarbageCollector.setPersistentThreshold(3);
----

* *Description:* Sets how many GC cycles an object must survive before
it’s considered persistent (long-lived).
* *Parameters:*
** _newPersistentThreshold_ (number)
* *Return Value:* The old threshold value.

'''''

==== GarbageCollector.setFullCollect

*Usage:*

[source,js]
----
let old = GarbageCollector.setFullCollect(1);
----

* *Description:* Enables or disables "`full`" collections (`+1+` for
true, `+0+` for false). Full collections handle both ephemeral and
persistent generations.
* *Parameters:*
** _fullCollect_ (number): 0 or 1
* *Return Value:* The old setting (0 or 1).

'''''

==== GarbageCollector.setIncremental

*Usage:*
[source,js]
----
let old = GarbageCollector.setIncremental(active);
----

* *Description:* Enables or disables the incremental garbage
collection mode. This is a global setting that affects all
collections. When incremental mode is enabled, the garbage
collector processes objects in smaller steps, allowing for
more responsive memory management.
* *Parameters:*
** _active_ (number): 0 or 1 (false or true)
* *Return Value:* The old setting (0 or 1).
* *Example:*
+
[source,js]
----
// Enable incremental garbage collection.
let oldSetting = GarbageCollector.setIncremental(1);
puts("Old incremental setting: ", oldSetting);
// Disable incremental garbage collection.
oldSetting = GarbageCollector.setIncremental(0);
puts("Old incremental setting: ", oldSetting);
----

'''''

==== GarbageCollector.setGenerational

*Usage:*
[source,js]
----
let old = GarbageCollector.setGenerational(active);
----

* *Description:* Enables or disables the generational garbage
collection mode. This is a global setting that affects all
collections. When generational mode is enabled, the garbage
collector treats objects differently based on their age, allowing for
more efficient memory management.
* *Parameters:*
** _active_ (number): 0 or 1 (false or true)
* *Return Value:* The old setting (0 or 1).
* *Example:*
+
[source,js]
----
// Enable generational garbage collection.
let oldSetting = GarbageCollector.setGenerational(1);
puts("Old generational setting: ", oldSetting);
// Disable generational garbage collection.
oldSetting = GarbageCollector.setGenerational(0);
puts("Old generational setting: ", oldSetting);
----

'''''

==== GarbageCollector.setLocalContextPoolSize

*Usage:*

[source,js]
----
let old = GarbageCollector.setLocalContextPoolSize(32);
----

* *Description:* Adjusts the size of the local context pool used for
reusing smaller contexts.
* *Parameters:*
** _newSize_ (number)
* *Return Value:* The old size.

'''''

==== GarbageCollector.setContextCacheSize

*Usage:*

[source,js]
----
let old = GarbageCollector.setContextCacheSize(64);
----

* *Description:* Sets how many contexts can be cached.
* *Parameters:*
** _newSize_ (number)
* *Return Value:* The old size.

'''''

==== GarbageCollector.setMinimumBlockSize

*Usage:*

[source,js]
----
let old = GarbageCollector.setMinimumBlockSize(16);
----

* *Description:* Changes the minimum block size for allocation in each
memory pool.
* *Parameters:*
** _newBlockSize_ (number)
* *Return Value:* The old block size.

'''''

=== Triggering Collection

These functions let you manually request garbage collection or single
cycles. They are useful if you want more control over memory usage.

==== GarbageCollector.collect

*Usage:*

[source,js]
----
GarbageCollector.collect();
----

* *Description:* Requests a *full* garbage collection and immediately
processes it. This runs through ephemeral and persistent objects,
calling finalizers where needed.
* *Return Value:* A numeric value (1). This is a dummy success code.

'''''

==== GarbageCollector.cycle

*Usage:*

[source,js]
----
GarbageCollector.cycle();
----

* *Description:* Requests an *incremental* or *partial* collection
cycle, marking and freeing some subset of objects. This is typically
less disruptive but may leave some objects for the next cycle.
* *Return Value:* A numeric value (1), a dummy success code.

'''''

=== Memory Usage Queries

These functions report the amount of memory (or number of objects)
currently allocated, used, or free in the GC system.

==== GarbageCollector.allocated

*Usage:*

[source,js]
----
let amount = GarbageCollector.allocated();
----

* *Description:* Returns the total count of allocated objects within the
system.
* *Return Value:* A numeric value representing the number of allocated
objects.

'''''

==== GarbageCollector.used

*Usage:*

[source,js]
----
let amount = GarbageCollector.used();
----

* *Description:* Returns how many allocated objects are actually in use
(allocated minus freed).
* *Return Value:* A numeric value (in objects).

'''''

==== GarbageCollector.free

*Usage:*

[source,js]
----
let amount = GarbageCollector.free();
----

* *Description:* Returns how many objects are in the free list (ready
for reuse).
* *Return Value:* A numeric value (in objects).

'''''

=== Summary

* *Global Object:* The *GarbageCollector* object allows you to configure
and interact with POCA’s garbage collection system, controlling how
aggressively and frequently collection occurs, and whether ephemeral
plus persistent objects are handled.
* *Parameter Getter/Setter Functions:*
** `+GarbageCollector.getStepFactor+`,
`+GarbageCollector.setStepFactor+`
** `+GarbageCollector.getIntervalFactor+`,
`+GarbageCollector.setIntervalFactor+`
** `+GarbageCollector.getGhostFactor+`,
`+GarbageCollector.setGhostFactor+`
** `+GarbageCollector.getSweepFactor+`,
`+GarbageCollector.setSweepFactor+`
** `+GarbageCollector.getPersistentInterval+`,
`+GarbageCollector.setPersistentInterval+`
** `+GarbageCollector.getPersistentThreshold+`,
`+GarbageCollector.setPersistentThreshold+`
** `+GarbageCollector.getFullCollect+`,
`+GarbageCollector.setFullCollect+`
** `+GarbageCollector.getIncremental+`,
`+GarbageCollector.setIncremental+`
** `+GarbageCollector.getGenerational+`,
`+GarbageCollector.setGenerational+`
** `+GarbageCollector.getLocalContextPoolSize+`,
`+GarbageCollector.setLocalContextPoolSize+`
** `+GarbageCollector.getContextCacheSize+`,
`+GarbageCollector.setContextCacheSize+`
** `+GarbageCollector.getMinimumBlockSize+`,
`+GarbageCollector.setMinimumBlockSize+`
* *GC Operations:*
** `+GarbageCollector.collect()+`: Forces a full collection (ephemeral +
persistent generations).
** `+GarbageCollector.cycle()+`: Runs an incremental or partial cycle.
* *Memory Usage:*
** `+GarbageCollector.allocated()+`: Number of allocated objects.
** `+GarbageCollector.used()+`: Number of currently used objects.
** `+GarbageCollector.free()+`: Number of free objects in the pool.
* *Usage:* By tuning these parameters, you can control how often GC runs
and how thoroughly it sweeps. You can also request manual partial or
full collections, or simply query how much memory is used. This
flexibility allows you to adapt POCA’s garbage collection strategy to
different performance requirements in a dynamic, typeless environment.
* *Note:* The garbage collector is designed to be efficient and
incremental, allowing for low-latency applications. The API provides
a comprehensive set of functions to manage memory usage and
performance tuning, making it suitable for a wide range of use cases.

== Global Functions

=== Overview

The POCA global functions provide a set of utility functions that
facilitate common operations in POCA scripts. These functions are
available globally and can be used without needing to create an
instance of any object. They include functions for type checking,
string manipulation, array handling, and more. The functions are
designed to be simple and intuitive, allowing you to perform
operations on various data types easily.

'''''

=== Global Functions

==== size

*Usage:*

[source,js]
----
let n = size(value);
----

* *Description:* Determines the size/length of the provided value, which
can be a string, array, or hash:
** *String*: Returns the string’s length. If UTF-8, returns its code
point count.
** *Array*: Returns the array’s number of elements.
** *Hash*: Returns the hash’s entry count.
** *Other types*: Returns `+0+`.
* *Parameters:*
** `+value+` (string | array | hash)
* *Return Value:* A numeric value.
* *Example:*
+
[source,js]
----
size("Hello");      // 5
size(["a","b","c"]); // 3
size({x:1,y:2});     // 2
size(42);            // 0
----

'''''

==== ownKeys

*Usage:*

[source,js]
----
let keysArray = ownKeys(myHash);
----

* *Description:* Returns an array of the *own* keys in a hash (i.e.,
keys directly in that hash, not in a prototype chain). The returned
array is sorted.
* *Parameters:*
** `+hash+` (hash): The hash from which to get keys.
* *Return Value:* An array of strings representing the hash’s own keys.
* *Example:*
+
[source,js]
----
let h = {a: 1, b: 2};
let arr = ownKeys(h); // ["a", "b"]
----

'''''

==== keys

*Usage:*

[source,js]
----
let keysArray = keys(myHash);
----

* *Description:* Similar to *ownKeys*, but for standard key enumeration
(which may differ if the hash uses prototypes or special handling). The
returned array is sorted.
* *Parameters:*
** `+hash+` (hash): The hash from which to get keys.
* *Return Value:* An array of strings representing the enumerated keys.
* *Example:*
+
[source,js]
----
let h = {a: 1, b: 2};
let arr = keys(h); // ["a", "b"]
----

'''''

==== print

*Usage:*

[source,js]
----
print(value1, value2, ...);
----

* *Description:* Prints each argument’s string representation (without a
newline). Accepts `+null+`, strings, or numbers. If a custom
`+UserIOWrite+` function is registered, it uses that; otherwise, it uses
`+System.Write+`.
* *Parameters:*
** `+valueX+`: The values to be printed (null, string, or number).
* *Return Value:* No meaningful return; the function returns `+null+`.
* *Example:*
+
[source,js]
----
print("Hello, ", 123);
// Output on the same line: Hello, 123
----

'''''

==== puts

*Usage:*

[source,js]
----
puts(value1, value2, ...);
----

* *Description:* Similar to `+print+`, but appends a newline at the end.
Accepts `+null+`, strings, or numbers. After printing all arguments,
writes a newline (`+"\n"+`).
* *Parameters:*
** `+valueX+`: The values to be printed (null, string, or number).
* *Return Value:* No meaningful return; the function returns `+null+`.
* *Example:*
+
[source,js]
----
puts("Hello, World!");
// Output: Hello, World!
// (plus a newline)
----

'''''

==== readLine

*Usage:*

[source,js]
----
let input = readLine(prompt);
----

* *Description:* Reads a line of input from the console. If a prompt
string is given, prints that before waiting for input. Uses
`+ReadLine(Context,promptValue)+` under the hood.
* *Parameters:*
** `+prompt+` (string, optional): A string to prompt the user.
* *Return Value:* A string with the line read from the user.
* *Example:*
+
[source,js]
----
let name = readLine("Enter name: ");
puts("Hello, " + name);
----

'''''

==== chr

*Usage:*

[source,js]
----
let charStr = chr(codePoint);
----

* *Description:* Converts a numeric code point to a single-character
string in UTF-8 form.
* *Parameters:*
** `+codePoint+` (number): The Unicode code point.
* *Return Value:* A string with that single character.
* *Example:*
+
[source,js]
----
chr(65); // "A"
----

'''''

==== contains

*Usage:*

[source,js]
----
if (contains(myHash, "someKey")) {
  puts("Yes");
}
----

* *Description:* Checks if a hash contains a specific key.
* *Parameters:*
[arabic]
. `+hash+` (hash): A hash object.
. `+key+` (any): The key to look for.
* *Return Value:* A numeric boolean (1 or 0).

'''''

==== import

See also *ModuleManager.import*.

*Usage:*

[source,js]
----
import * from "ModuleName";
import a, b from "ModuleName";
// or function call:
import("ModuleName", ["a","b"], allowReloadIfNewer);
----

* *Description:* Loads the specified module (if not already cached),
optionally reloading if newer. If a list of imports is provided, only
those symbols are pulled into the current scope. If `+["*"]+` or
`+["all"]+` is used, it imports all available exports.
* *Parameters:*
** `+moduleName+` (string): The name/path of the module.
** `+imports+` (array, optional): Which symbols to import.
** `+allowReloadIfNewer+` (boolean, optional): If `+true+`, checks if
the file has changed.
* *Return Value:* If called via syntax `+import ... from ...;+`, it
doesn’t return a value. If called as
`+import(moduleName, imports, reload)+`, it returns the module’s scope
or exported hash.

'''''

==== require

See also *ModuleManager.require*.

*Usage:*

[source,js]
----
let moduleObj = require("ModuleName", allowReloadIfNewer);
----

* *Description:* Loads (and possibly reloads) the specified module,
returning whatever the module returned. This can be an object, function,
or anything else the module’s code ends with `+return+`.
* *Parameters:*
** `+moduleName+` (string): The name/path of the module.
** `+allowReloadIfNewer+` (boolean, optional): If `+true+`, checks if
the module file changed.
* *Return Value:* The module’s exported object.

'''''

==== eval

*Usage:*

[source,js]
----
let result = eval(codeString, filename, callArguments, callThis, callNamespace);
----

* *Description:* Compiles and executes a code string in a sub-context.
Optionally provides:
** `+filename+`: for debugging reference
** `+callArguments+`: array of arguments
** `+callThis+`: "`this`" binding
** `+callNamespace+`: a namespace object (hash) for top-level scope
* *Parameters:*
[arabic]
. `+codeString+` (string): The POCA code to compile and run.
. `+filename+` (string, optional): Used for debugging or error messages.
. `+callArguments+` (array, optional): If present, these are passed as
function arguments.
. `+callThis+` (hash | ghost, optional): The `+this+` context for the
eval code.
. `+callNamespace+` (hash, optional): The namespace in which the code
runs.
* *Return Value:* Whatever the eval’d code returns.

'''''

==== compile

*Usage:*

[source,js]
----
let codeObject = compile(source, filename, rawCode);
----

* *Description:* Compiles `+source+` into a code object. If `+rawCode+`
is `+false+` or omitted, `+compile+` then "`binds`" the code object to
the current context, making it directly callable. If `+rawCode+` is
`+true+`, you get just the raw code object.
* *Parameters:*
[arabic]
. `+source+` (string): The POCA code to compile.
. `+filename+` (string, optional): For debugging or references.
. `+rawCode+` (boolean, optional): If true, returns just raw code
object; otherwise returns a code object bound to the current context.
* *Return Value:* A code object (raw or bound).

'''''

==== caller

*Usage:*

[source,js]
----
let info = caller(level);
----

* *Description:* Returns an array of information about a stack frame.
The default `+level+` is `+1+`, which means the caller of the current
function.
* *Parameters:*
** `+level+` (number): How many levels to go up the call stack. 0 means
current frame, 1 is the caller, etc.
* *Return Value:* An array containing
`+[localsHash, func, obj, sourceFile, lineNumber]+` for that frame, or
`+null+` if out of range.

'''''

==== closure

*Usage:*

[source,js]
----
let arr = closure(func, index);
----

* *Description:* Returns the `+[namespace, obj]+` pair from a function
closure in a chain. If a function has "`next`" references (like chained
closures), `+index+` selects which link in the chain.
* *Parameters:*
[arabic]
. `+func+` (function): The function to inspect.
. `+index+` (number): Which link in the chain (0 for the first, 1 for
next, etc.).
* *Return Value:* An array `+[namespace, obj]+` or `+null+` if out of
range.

'''''

==== bind

*Usage:*

[source,js]
----
let newFunc = bind(originalFunc, namespaceHash, obj, next);
----

* *Description:* Creates a new function object based on `+originalFunc+`
but with a new namespace, optional "`this`" (obj), and optional `+next+`
reference. This effectively re-binds a function’s environment.
* *Parameters:*
[arabic]
. `+originalFunc+` (function): The function to clone.
. `+namespaceHash+` (hash): The new namespace.
. `+obj+` (function, optional): The new "`this`" object (or `+null+`).
. `+next+` (function, optional): The new `+next+` closure link.
* *Return Value:* A newly created function.

'''''

==== call

*Usage:*

[source,js]
----
let result = call(func, argumentsArray, thisVal, namespace);
----

* *Description:* Calls a function in a sub-context, optionally
providing:
** `+argumentsArray+`: an array of arguments
** `+thisVal+`: a "`this`" context
** `+namespace+`: an alternate top-level namespace
* *Parameters:*
[arabic]
. `+func+` (function): The function to call.
. `+argumentsArray+` (array, optional)
. `+thisVal+` (hash | ghost, optional)
. `+namespace+` (hash, optional)
* *Return Value:* Whatever the function call returns.

'''''

==== setHashEvents

*Usage:*

[source,js]
----
setHashEvents(myHash, eventsHash);
----

* *Description:* Attaches a special events hash to a hash. This can
override meta-operations (get, set, etc.). Returns the original hash.
* *Parameters:*
[arabic]
. `+myHash+` (hash)
. `+eventsHash+` (hash)
* *Return Value:* The original `+myHash+`.

'''''

==== getHashEvents

*Usage:*

[source,js]
----
let ev = getHashEvents(myHash);
----

* *Description:* Retrieves the current events hash associated with a
hash, if any.
* *Parameters:*
** `+myHash+` (hash)
* *Return Value:* A hash representing the events, or `+null+` if no
special events are assigned.

'''''

==== rawDelete

*Usage:*

[source,js]
----
let success = rawDelete(myHash, key);
----

* *Description:* Deletes a key in a hash *without* invoking meta-events
(`+setHashEvents+`). Returns 1 if a key was deleted, 0 otherwise.
* *Parameters:*
[arabic]
. `+myHash+` (hash)
. `+key+` (any)
* *Return Value:* A numeric boolean (1 or 0).

'''''

==== rawExist

*Usage:*

[source,js]
----
let yesNo = rawExist(myHash, key);
----

* *Description:* Checks if a key exists in a hash *without* invoking
meta-events. Returns 1 if present, 0 if not.
* *Parameters:*
[arabic]
. `+myHash+` (hash)
. `+key+` (any)
* *Return Value:* A numeric boolean (1 or 0).

'''''

==== rawGet

*Usage:*

[source,js]
----
let val = rawGet(myHash, key);
----

* *Description:* Retrieves the value from a hash for a given key
*without* triggering meta-events.
* *Parameters:*
[arabic]
. `+myHash+` (hash)
. `+key+` (any)
* *Return Value:* The value associated with `+key+`, or `+null+` if not
found.

'''''

==== rawSet

*Usage:*

[source,js]
----
rawSet(myHash, key, value);
----

* *Description:* Sets a key in a hash *without* meta-events.
* *Parameters:*
[arabic]
. `+myHash+` (hash)
. `+key+` (any)
. `+value+` (any)
* *Return Value:* Returns the `+myHash+` object.

'''''

==== rawSize

*Usage:*

[source,js]
----
let n = rawSize(myHash);
----

* *Description:* Returns the number of entries in a hash *without*
meta-events. Equivalent to the internal hash size.
* *Parameters:*
** `+myHash+` (hash)
* *Return Value:* A numeric value representing the entry count.

'''''

==== rawKeys

*Usage:*

[source,js]
----
let kArray = rawKeys(myHash);
----

* *Description:* Returns an array of key strings from the hash *without*
meta-events. The array is sorted.
* *Parameters:*
** `+myHash+` (hash)
* *Return Value:* A sorted array of keys.

'''''

=== Summary

*Global Functions in POCA*

The global namespace contains a variety of utilities that let you: 

1. *Interact with arrays, hashes, and strings* using `+size+`, `+ownKeys+`,
`+keys+`, etc. 
2. *Perform console I/O* with `+print+`, `+puts+`, and
`+readLine+`. 
3. *Manage or query modules* with `+import+`, `+require+`
(duplicates of ModuleManager’s functions). 
4. *Evaluate code* with
`+eval+` and `+compile+`, manipulate function closures with `+caller+`,
`+closure+`, `+bind+`, and `+call+`. 
5. *Control or bypass hash
meta-events* with `+rawGet+`, `+rawSet+`, etc.

These functions enable rapid scripting and flexible data handling in
POCA’s dynamic environment. When combined with the features of
*ModuleManager* and other built-in namespaces (like *IO*, *Array*,
etc.), they provide a rich and extensible standard library for your POCA
code.

*Note:* The global functions are designed to be easy to use and
understand, making them suitable for both beginners and experienced
developers. They provide a consistent interface for common tasks,
allowing you to focus on your application logic rather than low-level
details.

== Hash

=== Overview

The POCA Hash API provides a set of functions to manipulate hash objects
(dictionaries) in POCA scripts. Hashes are key–value collections with
their own built-in methods for querying, modifying, and managing
properties. The API includes functions to check if a hash is empty, get
its size, add entries from another hash, query for keys, and even bypass
meta-event handling with "`raw`" operations.

'''''

=== API Functions

==== Hash.empty

*Usage:*

[source,js]
----
let isEmpty = myHash.empty();
----

* *Description:* Checks if the hash contains no entries. Returns `+1+`
(true) if the hash is empty, or `+0+` (false) otherwise.
* *Parameters:* None.
* *Return Value:* A numeric boolean (1 if empty, 0 otherwise).

'''''

==== Hash.size

*Usage:*

[source,js]
----
let n = myHash.size();
----

* *Description:* Returns the number of entries in the hash.
* *Parameters:* None.
* *Return Value:* A numeric value representing the number of key–value
pairs.

'''''

==== Hash.merge

*Usage:*

[source,js]
----
myHash.merge(anotherHash);
----

* *Description:* Merges entries from one or more hash objects into the
current hash. Only arguments that are hashes are processed; others are
ignored.
* *Parameters:* One or more hash objects to merge.
* *Return Value:* The original hash (after merging).

'''''

==== Hash.contains

*Usage:*

[source,js]
----
let present = myHash.contains("keyName");
----

* *Description:* Checks whether the hash contains a given key. Returns
`+1+` (true) if the key is present, or `+0+` (false) otherwise.
* *Parameters:*
** `+key+` (any): The key to look for.
* *Return Value:* A numeric boolean.

'''''

==== Hash.keys

*Usage:*

[source,js]
----
let keysArray = myHash.keys();
----

* *Description:* Returns a sorted array of all keys in the hash
(including inherited ones, depending on the implementation).
* *Parameters:* None.
* *Return Value:* An array of keys.

'''''

==== Hash.ownKeys

*Usage:*

[source,js]
----
let ownKeysArray = myHash.ownKeys();
----

* *Description:* Returns a sorted array of the hash’s own keys
(excluding keys inherited from prototypes).
* *Parameters:* None.
* *Return Value:* An array of strings representing the hash’s own keys.

'''''

==== Hash.setHashEvents

*Usage:*

[source,js]
----
myHash.setHashEvents(eventsHash);
----

* *Description:* Attaches a special events hash to the hash. These
events can override standard meta-operations like property access or
modification. Returns the original hash.
* *Parameters:*
** `+eventsHash+` (hash): A hash containing event handlers.
* *Return Value:* The original `+myHash+`.

'''''

==== Hash.getHashEvents

*Usage:*

[source,js]
----
let events = myHash.getHashEvents();
----

* *Description:* Retrieves the events hash associated with the hash, if
any.
* *Parameters:* None.
* *Return Value:* A hash representing the events, or `+null+` if no
special events are assigned.

'''''

==== Hash.rawDelete

*Usage:*

[source,js]
----
let success = myHash.rawDelete("keyName");
----

* *Description:* Deletes a key in the hash *without* invoking
meta-events. Returns `+1+` if a key was deleted, `+0+` otherwise.
* *Parameters:*
** `+key+` (any): The key to delete.
* *Return Value:* A numeric boolean (1 or 0).

'''''

==== Hash.rawExist

*Usage:*

[source,js]
----
let exists = myHash.rawExist("keyName");
----

* *Description:* Checks if a key exists in the hash *without* invoking
meta-events. Returns `+1+` if present, `+0+` if not.
* *Parameters:*
** `+key+` (any): The key to check.
* *Return Value:* A numeric boolean (1 or 0).

'''''

==== Hash.rawGet

*Usage:*

[source,js]
----
let value = myHash.rawGet("keyName");
----

* *Description:* Retrieves the value from a hash for a given key
*without* triggering meta-events.
* *Parameters:*
** `+key+` (any): The key to look up.
* *Return Value:* The value associated with `+key+`, or `+null+` if not
found.

'''''

==== Hash.rawSet

*Usage:*

[source,js]
----
myHash.rawSet("keyName", someValue);
----

* *Description:* Sets a key in the hash *without* meta-events.
* *Parameters:*
[arabic]
. `+key+` (any): The key to set.
. `+value+` (any): The value to assign.
* *Return Value:* Returns the original `+myHash+`.

'''''

==== Hash.rawSize

*Usage:*

[source,js]
----
let n = myHash.rawSize();
----

* *Description:* Returns the number of entries in the hash *without*
meta-events. Equivalent to the internal hash size.
* *Parameters:* None.
* *Return Value:* A numeric value representing the entry count.

'''''

==== Hash.rawKeys

*Usage:*

[source,js]
----
let kArray = myHash.rawKeys();
----

* *Description:* Returns an array of key strings from the hash *without*
meta-events. The array is sorted.
* *Parameters:* None.
* *Return Value:* A sorted array of keys.

'''''

=== Summary

* *Global Object:* The Hash object is a native collection type in POCA
used for key–value storage. It provides a comprehensive suite of
functions for querying and manipulating its entries.
* *Hash API Functions:*
** *Hash.empty:* Checks if the hash is empty.
** *Hash.size:* Returns the number of entries.
** *Hash.merge:* Merges other hash objects into the current hash.
** *Hash.contains:* Checks for the presence of a key.
** *Hash.keys / Hash.ownKeys:* Retrieve sorted arrays of keys.
** *Hash.setHashEvents / Hash.getHashEvents:* Attach or retrieve custom
event handlers for hash operations.
** *Hash.rawDelete, Hash.rawExist, Hash.rawGet, Hash.rawSet,
Hash.rawSize, Hash.rawKeys:* Perform low-level operations on the hash
bypassing meta-events.
* *Usage:* These global functions enable flexible and efficient
manipulation of hash objects in POCA. They support both standard
high-level operations and low-level "`raw`" operations that bypass
additional event processing, providing developers with fine-grained
control over data structures in a dynamic, typeless environment.
* *Note:* The Hash API is designed to be intuitive and easy to use,
allowing developers to work with hash objects without needing to
understand the underlying implementation details. The functions are
optimized for performance and can handle large datasets efficiently.

== IO

=== Overview

The POCA IO API provides file input/output functionality for a dynamic,
typeless language. Instead of dealing with static types, you interact
with a global *IO* object. The *IO.open* method creates a ghost object
that represents a file, and you call I/O methods directly on that ghost
object. The API supports both text and binary modes while handling
resource management internally.

'''''

=== Global Object: *IO*

The *IO* object is the entry point for file operations. It offers:

==== IO.open

*Usage:*

[source,js]
----
let file = IO.open(filename, mode);
----

* *Parameters:*
** `+filename+` (string): The file name or path.
** `+mode+` (string, optional): Determines how the file is opened. Modes
include:
*** *Text Modes:*
**** `+"r"+`: Open for reading.
**** `+"rw"+`: Open for reading and writing.
**** `+"w"+`: Open for writing (creates the file if it does not exist,
or truncates it if it does).
**** `+"c"+`: Open for reading and writing, creating the file if it does
not exist.
*** *Binary Modes:*
**** `+"rb"+`: Open for reading in binary mode.
**** `+"rwb"+`: Open for reading and writing in binary mode.
**** `+"wb"+`: Open for writing in binary mode (creates/truncates as
needed).
**** `+"cb"+`: Open for reading and writing in binary mode, creating the
file if necessary.
* *Return Value:* A ghost object representing the file. This object
exposes various methods for file I/O.
* *Example:*
+
[source,js]
----
// Open a text file for reading
let file = IO.open("example.txt", "r");
----

'''''

==== IO.getDirectoryEntries

*Usage:*
[source,js]
----
let entries = IO.getDirectoryEntries(directoryPath);
----
* *Description:* Returns an array of hashes/objects of file and directory
entries in the specified directory. Each entry contains information
about the file or directory, such as its name, size, and type.
* *Parameters:*
** `+directoryPath+` (string): The path to the directory to list.
* *Return Value:* An array of hashes/objects, each representing a file
or directory entry.
* *Example:*
+
[source,js]
----
// Get entries in the current directory
let entries = IO.getDirectoryEntries("./*");
foreach(let entry in entries) {
    puts("Name: ", entry.name);
    puts("Size: ", entry.size);
    puts("Type: ", entry.type);
}
----
* *Note:* The entries returned may include files, directories, and
other types of objects, depending on the file system and the
directory contents. The `+type+` field in the entry hash/object
indicates whether the entry is a file, directory, or other type. The
`+size+` field may not be applicable for directories. The `+name+`
field contains the name of the entry.

''''''

=== File Ghost Object Methods

Once you have a file ghost object, the following methods are available:

==== IO.read

*Usage:*

[source,js]
----
let data = file.read(length);
----

* *Description:* Reads data from the file.
** *Text Mode:* Reads and returns a string.
** *Binary Mode:* Reads a specified number of bytes (defaults to 1 if
omitted).
* *Return Value:* A string containing the data read. Returns a null
value if the file is not open or an error occurs.
* *Example:*
+
[source,js]
----
// Read 10 characters/bytes
let chunk = file.read(10);
----

'''''

==== IO.readln

*Usage:*

[source,js]
----
let line = file.readln();
----

* *Description:* Reads a full line from the file (only applicable in
text mode). In binary mode, it returns a null value or no action occurs.
* *Return Value:* A string containing the line read from the file.
* *Example:*
+
[source,js]
----
let line = file.readln();
----

'''''

==== IO.write

*Usage:*

[source,js]
----
let count = file.write(data);
----

* *Description:* Writes the provided string `+data+` to the file.
** In *text mode*, the string is written directly.
** In *binary mode*, the string (or its byte representation) is written
using block write operations.
* *Return Value:* The number of characters (or bytes) written.
* *Example:*
+
[source,js]
----
let bytesWritten = file.write("Hello, POCA!");
----

'''''

==== IO.writeln

*Usage:*

[source,js]
----
let count = file.writeln(data);
----

* *Description:* Writes the string `+data+` followed by a newline
sequence (platform-dependent, e.g., `+\n+` on Unix-like systems or
`+\r\n+` on others).
* *Return Value:* The total number of characters (or bytes) written,
including the newline.
* *Example:*
+
[source,js]
----
let count = file.writeln("This is a new line.");
----

'''''

==== IO.eof

*Usage:*

[source,js]
----
let atEnd = file.eof();
----

* *Description:* Checks whether the file pointer has reached the
end-of-file.
* *Return Value:* A truthy value (e.g., `+true+` or `+1+`) if the end is
reached, otherwise a falsy value (e.g., `+false+` or `+0+`).
* *Example:*
+
[source,js]
----
if (file.eof()) {
    // End of file reached
}
----

'''''

==== IO.close

*Usage:*

[source,js]
----
file.close();
----

* *Description:* Closes the file associated with the ghost object. This
method ensures that any open file handles are closed and that allocated
resources are freed. It handles system handles (which should not be
freed) appropriately.
* *Return Value:* A numeric value indicating whether the file was open
(for example, `+1+` if open, `+0+` otherwise).
* *Example:*
+
[source,js]
----
file.close();
----

'''''

=== Example Usage

Below is a complete example that demonstrates opening a file, processing
its contents, and closing it using the POCA IO API. Remember, for
output, use `+puts+` for printing with a newline and `+print+` for
printing without one.

[source,js]
----
// Open a text file for reading
let file = IO.open("data.txt", "r");
if (file) {
    // Read and output each line until end-of-file
    while (!file.eof()) {
        let line = file.readln();
        puts(line);
    }
    file.close();
} else {
    puts("Failed to open file.");
}

// Open a binary file for writing
let binFile = IO.open("image.bin", "wb");
if (binFile) {
    let data = "binary data";
    let bytesWritten = binFile.write(data);
    puts("Wrote " + bytesWritten + " bytes to binary file.");
    binFile.close();
} else {
    puts("Failed to open binary file.");
}
----

=== Summary

* *Global Object:* The API is accessed via the *IO* object.
* *File Ghost Object:* Methods like `+read+`, `+readln+`, `+write+`,
`+writeln+`, `+eof+`, and `+close+` are available directly on the object
returned by *IO.open*.
* *Mode Options:* Various text and binary modes allow you to control
file access precisely.

This documentation should help you integrate file I/O in your POCA
projects using a simple, dynamic approach.

== Lock

=== Overview

The POCA Lock API provides mutual exclusion mechanisms for synchronizing
access to shared resources in concurrent POCA scripts. Locks in POCA are
dynamic, typeless ghost objects created via a factory function. These
ghost objects offer methods to acquire and release the lock, ensuring
that only one execution context can access a critical section at a time.

'''''

=== Global Lock Object

The global *Lock* object serves as both a factory and a namespace for
lock operations. You can create lock ghost objects using either of the
following variants:

==== Lock.create(), or new Lock()

*Usage:*

[source,js]
----
let lock = Lock.create();
----

or equivalently,

[source,js]
----
let lock = new Lock();
----

* *Description:* `+Lock.create()+` or `+new Lock()+` creates a new lock
ghost object by invoking the underlying lock creation routine. The
resulting ghost object represents a mutual exclusion lock, which is
registered for subsequent lock operations.
* *Parameters:* None.
* *Return Value:* A lock ghost object that can be used to control access
to shared resources.
* *Example:*
+
[source,js]
----
// Create a new lock using either syntax.
let lock1 = Lock.create();
let lock2 = new Lock();
----

'''''

=== Methods on Lock Ghost Objects

Once created, a lock ghost object provides the following methods:

==== Lock.enter

*Usage:*

[source,js]
----
lock.enter();
----

* *Description:* Acquires the lock. The garbage collector is unlocked
while the lock is being acquired to prevent deadlocks. This method
returns a numeric value (1) to indicate that the lock has been
successfully acquired.
* *Parameters:* None.
* *Return Value:* A numeric boolean value: `+1+` if the lock was
acquired successfully, `+0+` otherwise.
* *Example:*
+
[source,js]
----
if (lock.enter()) {
  // Critical section: safely access shared resources.
}
----

'''''

==== Lock.leave

*Usage:*

[source,js]
----
lock.leave();
----

* *Description:* Releases the lock, allowing other execution contexts to
acquire it.
* *Parameters:* None.
* *Return Value:* A null value.
* *Example:*
+
[source,js]
----
// Release the lock after finishing the critical section.
lock.leave();
----

'''''

=== Summary

* *Global Object:* The Lock object acts as a factory for creating lock
ghost objects. `+Lock.create()+` or `+new Lock()+` creates a new lock
ghost object by invoking the underlying lock creation routine. The
resulting ghost object represents a mutual exclusion lock, which is
registered for subsequent lock operations.
* *Lock Ghost Object Methods:* Once created, lock ghost objects provide
the following methods to control mutual exclusion:
** *enter:* Acquires the lock.
** *leave:* Releases the lock.
* *Usage:* Locks enable you to synchronize access to shared resources in
concurrent POCA scripts, ensuring that only one execution context can
access a critical section at a time.

This comprehensive API lets you incorporate locking mechanisms into your
POCA projects, providing essential synchronization for concurrent
execution.

== Math

=== Overview

The POCA Math API provides a set of mathematical constants and functions
for numerical calculations in POCA scripts. These include basic
arithmetic functions, trigonometric functions, hyperbolic functions,
exponentiation, logarithms, and checks for numeric properties (e.g.,
whether a number is finite or NaN). The global *Math* object acts as a
namespace for these constants and functions, making them readily
accessible in your scripts. All trigonometric and hyperbolic functions
in this API use radians.

'''''

=== Global Math Object

The global *Math* object houses numerical constants (such as `+Math.PI+`
and `+Math.E+`) and a collection of native functions for mathematical
operations.

'''''

=== Math Constants

Below is a list of each constant on *Math*, each in its own section:

==== Math.PI

* *Description:* The mathematical constant π, approximately
`+3.141592653589793+`.

==== Math.E

* *Description:* The base of natural logarithms, _e_, approximately
`+2.718281828459045+`.

==== Math.LN2

* *Description:* The natural logarithm of 2, i.e., `+ln(2)+`.

==== Math.LN10

* *Description:* The natural logarithm of 10, i.e., `+ln(10)+`.

==== Math.LOG10E

* *Description:* The base-10 logarithm of e, i.e., `+log10(e)+`.

==== Math.LOG2E

* *Description:* The base-2 logarithm of e, i.e., `+log2(e)+`.

==== Math.SQRT1_2

* *Description:* The square root of 1/2.

==== Math.SQRT2

* *Description:* The square root of 2.

==== Math.NaN

* *Description:* Represents "`Not-a-Number.`"

==== Math.Infinity

* *Description:* A positive infinite value.

'''''

=== Math Functions

Below is a complete list of *Math* functions. For each function, the
usage, description, parameters, return value, and an example are
included to ensure no details are lost.

==== Math.min

*Usage:*

[source,js]
----
let value = Math.min(a, b);
----

* *Description:* Returns the smaller of the two numeric values `+a+` and
`+b+`.
* *Parameters:*
** `+a+` (number): The first value.
** `+b+` (number): The second value.
* *Return Value:* The smaller of `+a+` and `+b+`.
* *Example:*
+
[source,js]
----
let x = Math.min(10, 3); // 3
----

'''''

==== Math.max

*Usage:*

[source,js]
----
let value = Math.max(a, b);
----

* *Description:* Returns the larger of the two numeric values `+a+` and
`+b+`.
* *Parameters:*
** `+a+` (number): The first value.
** `+b+` (number): The second value.
* *Return Value:* The larger of `+a+` and `+b+`.
* *Example:*
+
[source,js]
----
let x = Math.max(10, 3); // 10
----

'''''

==== Math.clamp

*Usage:*

[source,js]
----
let value = Math.clamp(num, minVal, maxVal);
----

* *Description:* Clamps `+num+` so that it is not less than `+minVal+`
and not greater than `+maxVal+`.
* *Parameters:*
** `+num+` (number): The value to clamp.
** `+minVal+` (number): The lower bound.
** `+maxVal+` (number): The upper bound.
* *Return Value:* The clamped value.
* *Example:*
+
[source,js]
----
let c = Math.clamp(5, 0, 3); // 3
----

'''''

==== Math.abs

*Usage:*

[source,js]
----
let value = Math.abs(x);
----

* *Description:* Returns the absolute value of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The absolute value of `+x+`.
* *Example:*
+
[source,js]
----
let v = Math.abs(-10); // 10
----

'''''

==== Math.sin

*Usage:*

[source,js]
----
let value = Math.sin(angle);
----

* *Description:* Returns the sine of `+angle+`, where `+angle+` is in
radians.
* *Parameters:*
** `+angle+` (number): The angle in radians.
* *Return Value:* The sine of the given angle.
* *Example:*
+
[source,js]
----
let s = Math.sin(Math.PI / 2); // 1
----

'''''

==== Math.cos

*Usage:*

[source,js]
----
let value = Math.cos(angle);
----

* *Description:* Returns the cosine of `+angle+`, where `+angle+` is in
radians.
* *Parameters:*
** `+angle+` (number): The angle in radians.
* *Return Value:* The cosine of the given angle.
* *Example:*
+
[source,js]
----
let c = Math.cos(Math.PI); // -1
----

'''''

==== Math.tan

*Usage:*

[source,js]
----
let value = Math.tan(angle);
----

* *Description:* Returns the tangent of `+angle+`, where `+angle+` is in
radians.
* *Parameters:*
** `+angle+` (number): The angle in radians.
* *Return Value:* The tangent of the given angle.
* *Example:*
+
[source,js]
----
let t = Math.tan(Math.PI / 4); // 1
----

'''''

==== Math.exp

*Usage:*

[source,js]
----
let value = Math.exp(x);
----

* *Description:* Returns _e^x_, where _e_ is the base of natural
logarithms.
* *Parameters:*
** `+x+` (number): The exponent.
* *Return Value:* _e^x_.
* *Example:*
+
[source,js]
----
let e = Math.exp(1); // ~2.718281828
----

'''''

==== Math.ln

*Usage:*

[source,js]
----
let value = Math.ln(x);
----

* *Description:* Returns the natural logarithm of `+x+` (i.e., _ln(x)_).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* _ln(x)_.
* *Example:*
+
[source,js]
----
let l = Math.ln(Math.E); // 1
----

'''''

==== Math.log

*Usage:*

[source,js]
----
let value = Math.log(x);
----

* *Description:* An alias for *Math.ln*, returning the natural logarithm
of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* _ln(x)_.
* *Example:*
+
[source,js]
----
let l2 = Math.log(Math.E); // 1
----

'''''

==== Math.sqr

*Usage:*

[source,js]
----
let value = Math.sqr(x);
----

* *Description:* Returns the square of `+x+` (i.e., x*x).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* _x^2_.
* *Example:*
+
[source,js]
----
let sq = Math.sqr(5); // 25
----

'''''

==== Math.sqrt

*Usage:*

[source,js]
----
let value = Math.sqrt(x);
----

* *Description:* Returns the square root of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The square root of `+x+`.
* *Example:*
+
[source,js]
----
let root = Math.sqrt(25); // 5
----

'''''

==== Math.atan2

*Usage:*

[source,js]
----
let angle = Math.atan2(y, x);
----

* *Description:* Returns the angle θ between the positive x-axis and the
point (x, y), in radians.
* *Parameters:*
** `+y+` (number): The y-coordinate.
** `+x+` (number): The x-coordinate.
* *Return Value:* The angle in radians in the range -π to π.
* *Example:*
+
[source,js]
----
let a = Math.atan2(1, 1); // ~π/4
----

'''''

==== Math.acos

*Usage:*

[source,js]
----
let value = Math.acos(x);
----

* *Description:* Returns the arccosine of `+x+`, in radians, in the
range 0 to π.
* *Parameters:*
** `+x+` (number): The input value (should be between -1 and 1).
* *Return Value:* The arccosine of `+x+`.
* *Example:*
+
[source,js]
----
let a = Math.acos(1); // 0
----

'''''

==== Math.asin

*Usage:*

[source,js]
----
let value = Math.asin(x);
----

* *Description:* Returns the arcsine of `+x+`, in radians, in the range
-π/2 to π/2.
* *Parameters:*
** `+x+` (number): The input value (between -1 and 1).
* *Return Value:* The arcsine of `+x+`.
* *Example:*
+
[source,js]
----
let a = Math.asin(0); // 0
----

'''''

==== Math.atan

*Usage:*

[source,js]
----
let value = Math.atan(x);
----

* *Description:* Returns the arctangent of `+x+`, in radians, in the
range -π/2 to π/2.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The arctangent of `+x+`.
* *Example:*
+
[source,js]
----
let a = Math.atan(1); // ~π/4
----

'''''

==== Math.cotan

*Usage:*

[source,js]
----
let value = Math.cotan(x);
----

* *Description:* Returns the cotangent of `+x+` (i.e., 1 / tan(x)).
* *Parameters:*
** `+x+` (number): The angle in radians.
* *Return Value:* The cotangent of `+x+`.
* *Example:*
+
[source,js]
----
let ct = Math.cotan(Math.PI / 4); // 1
----

'''''

==== Math.secant

*Usage:*

[source,js]
----
let value = Math.secant(x);
----

* *Description:* Returns the secant of `+x+` (i.e., 1 / cos(x)).
* *Parameters:*
** `+x+` (number): The angle in radians.
* *Return Value:* The secant of `+x+`.
* *Example:*
+
[source,js]
----
let sc = Math.secant(0); // 1
----

'''''

==== Math.cosecant

*Usage:*

[source,js]
----
let value = Math.cosecant(x);
----

* *Description:* Returns the cosecant of `+x+` (i.e., 1 / sin(x)).
* *Parameters:*
** `+x+` (number): The angle in radians.
* *Return Value:* The cosecant of `+x+`.
* *Example:*
+
[source,js]
----
let co = Math.cosecant(Math.PI / 2); // 1
----

'''''

==== Math.hypot

*Usage:*

[source,js]
----
let value = Math.hypot(a, b);
----

* *Description:* Returns the square root of (a^2 + b^2), typically used
for computing the length of the hypotenuse in a right-angled triangle.
* *Parameters:*
** `+a+` (number): First coordinate.
** `+b+` (number): Second coordinate.
* *Return Value:* The hypotenuse length.
* *Example:*
+
[source,js]
----
let h = Math.hypot(3, 4); // 5
----

'''''

==== Math.ceil

*Usage:*

[source,js]
----
let value = Math.ceil(x);
----

* *Description:* Returns `+x+` rounded upward to the nearest integer.
* *Parameters:*
** `+x+` (number): The number to round.
* *Return Value:* The smallest integer greater than or equal to `+x+`.
* *Example:*
+
[source,js]
----
let c = Math.ceil(1.2); // 2
----

'''''

==== Math.floor

*Usage:*

[source,js]
----
let value = Math.floor(x);
----

* *Description:* Returns `+x+` rounded downward to the nearest integer.
* *Parameters:*
** `+x+` (number): The number to round.
* *Return Value:* The largest integer less than or equal to `+x+`.
* *Example:*
+
[source,js]
----
let f = Math.floor(1.8); // 1
----

'''''

==== Math.log10

*Usage:*

[source,js]
----
let value = Math.log10(x);
----

* *Description:* Returns the base-10 logarithm of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The base-10 logarithm of `+x+`.
* *Example:*
+
[source,js]
----
let l10 = Math.log10(100); // 2
----

'''''

==== Math.log2

*Usage:*

[source,js]
----
let value = Math.log2(x);
----

* *Description:* Returns the base-2 logarithm of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The base-2 logarithm of `+x+`.
* *Example:*
+
[source,js]
----
let l2 = Math.log2(8); // 3
----

'''''

==== Math.logn

*Usage:*

[source,js]
----
let value = Math.logn(base, x);
----

* *Description:* Returns the base-`+base+` logarithm of `+x+`.
* *Parameters:*
** `+base+` (number): The logarithm base.
** `+x+` (number): The input value.
* *Return Value:* The base-`+base+` logarithm of `+x+`.
* *Example:*
+
[source,js]
----
let ln = Math.logn(5, 25); // 2
----

'''''

==== Math.pow

*Usage:*

[source,js]
----
let value = Math.pow(x, y);
----

* *Description:* Raises `+x+` to the power `+y+` (i.e., _x^y_).
* *Parameters:*
** `+x+` (number): The base.
** `+y+` (number): The exponent.
* *Return Value:* _x^y_.
* *Example:*
+
[source,js]
----
let p = Math.pow(2, 5); // 32
----

'''''

==== Math.sinh

*Usage:*

[source,js]
----
let value = Math.sinh(x);
----

* *Description:* Returns the hyperbolic sine of `+x+`.
* *Parameters:*
** `+x+` (number): The input value in radians.
* *Return Value:* The hyperbolic sine of `+x+`.
* *Example:*
+
[source,js]
----
let sh = Math.sinh(0); // 0
----

'''''

==== Math.cosh

*Usage:*

[source,js]
----
let value = Math.cosh(x);
----

* *Description:* Returns the hyperbolic cosine of `+x+`.
* *Parameters:*
** `+x+` (number): The input value in radians.
* *Return Value:* The hyperbolic cosine of `+x+`.
* *Example:*
+
[source,js]
----
let ch = Math.cosh(0); // 1
----

'''''

==== Math.tanh

*Usage:*

[source,js]
----
let value = Math.tanh(x);
----

* *Description:* Returns the hyperbolic tangent of `+x+`.
* *Parameters:*
** `+x+` (number): The input value in radians.
* *Return Value:* The hyperbolic tangent of `+x+`.
* *Example:*
+
[source,js]
----
let th = Math.tanh(1); // ~0.76159
----

'''''

==== Math.asinh

*Usage:*

[source,js]
----
let value = Math.asinh(x);
----

* *Description:* Returns the inverse hyperbolic sine of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The inverse hyperbolic sine of `+x+`.
* *Example:*
+
[source,js]
----
let ash = Math.asinh(0); // 0
----

'''''

==== Math.acosh

*Usage:*

[source,js]
----
let value = Math.acosh(x);
----

* *Description:* Returns the inverse hyperbolic cosine of `+x+` (where x
≥ 1).
* *Parameters:*
** `+x+` (number): The input value (≥ 1).
* *Return Value:* The inverse hyperbolic cosine of `+x+`.
* *Example:*
+
[source,js]
----
let ach = Math.acosh(1); // 0
----

'''''

==== Math.atanh

*Usage:*

[source,js]
----
let value = Math.atanh(x);
----

* *Description:* Returns the inverse hyperbolic tangent of `+x+`
(typically between -1 and 1).
* *Parameters:*
** `+x+` (number): The input value. Typically a value between -1 and 1.
* *Return Value:* The inverse hyperbolic tangent of `+x+`.
* *Example:*
+
[source,js]
----
let ath = Math.atanh(0); // 0
----

'''''

==== Math.coth

*Usage:*

[source,js]
----
let value = Math.coth(x);
----

* *Description:* Returns the hyperbolic cotangent of `+x+` (i.e., 1 /
tanh(x)).
* *Parameters:*
** `+x+` (number): The input value in radians.
* *Return Value:* The hyperbolic cotangent of `+x+`.
* *Example:*
+
[source,js]
----
let cth = Math.coth(1); // ~1.313035
----

'''''

==== Math.sech

*Usage:*

[source,js]
----
let value = Math.sech(x);
----

* *Description:* Returns the hyperbolic secant of `+x+` (i.e., 1 /
cosh(x)).
* *Parameters:*
** `+x+` (number): The input value in radians.
* *Return Value:* The hyperbolic secant of `+x+`.
* *Example:*
+
[source,js]
----
let sch = Math.sech(0); // 1
----

'''''

==== Math.csch

*Usage:*

[source,js]
----
let value = Math.csch(x);
----

* *Description:* Returns the hyperbolic cosecant of `+x+` (i.e., 1 /
sinh(x)).
* *Parameters:*
** `+x+` (number): The input value in radians.
* *Return Value:* The hyperbolic cosecant of `+x+`.
* *Example:*
+
[source,js]
----
let csh = Math.csch(1); // ~0.850918
----

'''''

==== Math.acot

*Usage:*

[source,js]
----
let value = Math.acot(x);
----

* *Description:* Returns the inverse cotangent of `+x+`, typically
computed as arctan(1/x).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The inverse cotangent of `+x+`.
* *Example:*
+
[source,js]
----
let ac = Math.acot(1); // ~π/4
----

'''''

==== Math.asec

*Usage:*

[source,js]
----
let value = Math.asec(x);
----

* *Description:* Returns the inverse secant of `+x+`, typically computed
as arccos(1/x).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The inverse secant of `+x+`.
* *Example:*
+
[source,js]
----
let as = Math.asec(1); // 0
----

'''''

==== Math.acsc

*Usage:*

[source,js]
----
let value = Math.acsc(x);
----

* *Description:* Returns the inverse cosecant of `+x+`, typically
computed as arcsin(1/x).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The inverse cosecant of `+x+`.
* *Example:*
+
[source,js]
----
let aC = Math.acsc(1); // π/2
----

'''''

==== Math.acoth

*Usage:*

[source,js]
----
let value = Math.acoth(x);
----

* *Description:* Returns the inverse hyperbolic cotangent of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The inverse hyperbolic cotangent of `+x+`.
* *Example:*
+
[source,js]
----
let ac = Math.acoth(2);
// Returns a valid double; no simple numeric example here.
----

'''''

==== Math.asech

*Usage:*

[source,js]
----
let value = Math.asech(x);
----

* *Description:* Returns the inverse hyperbolic secant of `+x+` (0 < x ≤
1).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The inverse hyperbolic secant of `+x+`.
* *Example:*
+
[source,js]
----
let as = Math.asech(1); // 0
----

'''''

==== Math.acsch

*Usage:*

[source,js]
----
let value = Math.acsch(x);
----

* *Description:* Returns the inverse hyperbolic cosecant of `+x+`.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The inverse hyperbolic cosecant of `+x+`.
* *Example:*
+
[source,js]
----
let acs = Math.acsch(2);
// No simple numeric result example here, but it returns a valid double.
----

'''''

==== Math.round

*Usage:*

[source,js]
----
let value = Math.round(x);
----

* *Description:* Rounds `+x+` to the nearest integer. If the fractional
portion is 0.5 or greater, rounds up; otherwise, rounds down.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The rounded integer.
* *Example:*
+
[source,js]
----
let r = Math.round(2.5); // 3
----

'''''

==== Math.trunc

*Usage:*

[source,js]
----
let value = Math.trunc(x);
----

* *Description:* Truncates `+x+` to an integer by removing any
fractional digits (toward zero).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The integer part of `+x+`.
* *Example:*
+
[source,js]
----
let t = Math.trunc(2.9); // 2
----

'''''

==== Math.int

*Usage:*

[source,js]
----
let value = Math.int(x);
----

* *Description:* Similar to `+Math.trunc(x)+`, returns the integer part
of `+x+`, discarding any fractional component.
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The integer part of `+x+`.
* *Example:*
+
[source,js]
----
let i = Math.int(-3.8); // -3
----

'''''

==== Math.random

*Usage:*

[source,js]
----
let value = Math.random();
----

* *Description:* Returns a random floating-point number between 0
(inclusive) and 1 (exclusive).
* *Parameters:* None.
* *Return Value:* A random number in the range [0, 1).
* *Example:*
+
[source,js]
----
let rand = Math.random(); // e.g., 0.714
----

'''''

==== Math.isNaN

*Usage:*

[source,js]
----
let value = Math.isNaN(x);
----

* *Description:* Checks whether `+x+` is Not-a-Number (NaN).
* *Parameters:*
** `+x+` (number): The value to test.
* *Return Value:* A numeric boolean value: 1 if `+x+` is NaN, 0
otherwise.
* *Example:*
+
[source,js]
----
let check = Math.isNaN(0 / 0); // 1
----

'''''

==== Math.isInfinite

*Usage:*

[source,js]
----
let value = Math.isInfinite(x);
----

* *Description:* Checks whether `+x+` is infinite (positive or negative
infinity).
* *Parameters:*
** `+x+` (number): The value to test.
* *Return Value:* A numeric boolean value: 1 if `+x+` is infinite, 0
otherwise.
* *Example:*
+
[source,js]
----
let inf = Math.isInfinite(Math.Infinity); // 1
----

'''''

==== Math.isFinite

*Usage:*

[source,js]
----
let value = Math.isFinite(x);
----

* *Description:* Checks whether `+x+` is a finite number.
* *Parameters:*
** `+x+` (number): The value to test.
* *Return Value:* A numeric boolean value: 1 if `+x+` is finite, 0
otherwise.
* *Example:*
+
[source,js]
----
let fin = Math.isFinite(10 / 2); // 1
----

'''''

==== Math.frac

*Usage:*

[source,js]
----
let value = Math.frac(x);
----

* *Description:* Returns the fractional part of `+x+` (i.e.,
`+x - floor(x)+` if `+x+` is positive, or `+x - ceil(x)+` if `+x+` is
negative).
* *Parameters:*
** `+x+` (number): The input value.
* *Return Value:* The fractional part of `+x+`.
* *Example:*
+
[source,js]
----
let fractional = Math.frac(2.75); // 0.75
----

'''''

=== Summary

* *Global Object:* The *Math* object serves as a namespace for
mathematical constants (like *Math.PI*, *Math.E*, *Math.NaN*,
*Math.Infinity*) and a wide array of numeric functions.
* *Math API Functions:* It includes functions for:
** Basic numeric comparisons: *Math.min*, *Math.max*, *Math.clamp*.
** Trigonometric/hyperbolic operations: *Math.sin*, *Math.cosh*,
*Math.atanh*, etc.
** Exponentiation, logarithms, and rounding: *Math.pow*, *Math.log10*,
*Math.floor*, *Math.round*.
** Random number generation: *Math.random*.
** Infinity checks: *Math.isInfinite*, *Math.isFinite*, *Math.isNaN*,
and more.
* *Usage:* This comprehensive set of constants and functions allows you
to perform advanced math operations in a dynamic, typeless environment.
From computing trigonometric functions to verifying numeric ranges, the
POCA Math API provides a robust toolset for numeric computations in POCA
scripts.
* *Note:* All trigonometric and hyperbolic functions in this API use
radians.

== ModuleManager

=== Overview

The POCA ModuleManager API provides a mechanism for dynamically loading,
unloading, and reloading modules within POCA scripts. A "`module`" is
simply a POCA script file (or code string) that can export symbols
(variables, functions, etc.) for use in other scripts. Once a module is
loaded, its exports and scope are cached, so subsequent imports or
requires can reuse them. This system supports both a JavaScript-like
`+import+` approach – which can selectively import symbols or import
everything using `+import * from ...+` – and a Lua-style `+require+`
concept – which returns whatever object the module exports or returns.

Modules are tracked internally by three global hashes: 

- *moduleScopes*: Stores the top-level scope (hash) of each loaded module. 
- *moduleValues*: Stores the exported object returned by the module
(relevant for `+require+`). 
- *moduleTimes*: Stores a timestamp indicating when the module was last 
loaded (used for conditional reloads).

The POCA engine also provides "`module loader functions`" that know how
to locate module files, load them, and return their code. When a module
is loaded, its code is compiled and executed in a sub-context. The
result is cached to avoid redundant work, though you can opt to force
reload if the underlying file changed.

'''''

=== Global ModuleManager Object

The global *ModuleManager* object is a namespace for module operations.
It stores references to the internal module registries and provides
functions to load, remove, or check modules. Additionally, the core
module-related functions (`+import+` and `+require+`) appear in both the
global namespace and the ModuleManager object.

==== ModuleManager Properties

* *moduleScopes*: A hash of module names to their scope objects.
* *moduleValues*: A hash of module names to their exported objects or
return values.
* *moduleTimes*: A hash of module names to numeric timestamps of last
load.

'''''

=== Global Module Functions

POCA provides two primary ways to load modules:

[arabic]
. *import*
. *require*

Although they differ in style, both retrieve (and possibly reload) the
target module, storing or returning relevant objects.

==== ModuleManager.import

*Usage:*

[source,js]
----
import * from "MyModule";
import a, b from "MyOtherModule";
// or:
ModuleManager.import("MyModule", ["a", "b"]);
----

* *Description:*
** If called via language syntax (`+import a, b from "MyOtherModule"+`),
it pulls the named exports into the current scope.
** If called as a function
(`+ModuleManager.import("name", importsArray[, reloadFlag])+`), it can
import specific symbols or `+*+` from the module’s exported object (or
scope).
** The underlying logic checks whether the module is already loaded. If
`+reloadFlag+` is true, the system checks if the file changed and may
reload it.
** The module can define its exported symbols in two ways:
[arabic]
. `+exports a, b, c;+` at the end (ECMAScript-like).
. `+return { a, b, c };+` at the end (Lua-style `+require+` approach).
** If an array of imports is specified, only those symbols are pulled
into the local scope. If you specify `+["*"]+` (or `+["all"]+`),
everything from the module is imported.
* *Parameters:*
** _moduleName_ (string): The name (or path) of the module.
** _imports_ (array, optional): An array of symbols to import (e.g.,
`+["symbol1", "symbol2"]+`, or `+["*"]+`).
** _allowReloadIfNewer_ (boolean, optional): If true, the system checks
timestamps to see if the module changed on disk and reloads if it’s
newer.
* *Return Value:*
** If used with the language syntax `+import ... from ...;+`, it doesn’t
directly return a value.
** If called as `+import(moduleName, imports, allowReloadIfNewer)+`, it
returns the module’s exported hash or the scope that was imported.
* *Example:*
+
[source,js]
----
import * from "MathLib";    // Imports all exported symbols from MathLib
import sin, cos from "Trig"; // Imports only 'sin' and 'cos'

// As a function call:
ModuleManager.import("StringUtils", ["trim", "toUpperCase"], true);
----

'''''

==== ModuleManager.require

*Usage:*

[source,js]
----
let moduleObj = require("MyModule");
----

or

[source,js]
----
let moduleObj = ModuleManager.require("MyModule", allowReloadIfNewer);
----

* *Description:*
** `+require+` loads the specified module, returning whatever the module
"`returns`".
** If the module is already cached, `+require+` uses the cached result
unless `+allowReloadIfNewer+` is true and the module file has changed.
** In the file, you can define:
+
[source,js]
----
return {
  a: 123,
  b: function() { ... }
};
----
+
This object is returned by `+require+`.
* *Parameters:*
** _moduleName_ (string): The name (or path) of the module.
** _allowReloadIfNewer_ (boolean, optional): If true, the system checks
timestamps and reloads the module if it has changed.
* *Return Value:* The module’s exported object, as determined by the
final `+return+` statement or `+exports+` usage.
* *Example:*
+
[source,js]
----
let myModule = require("MyModule");
if (myModule) {
  // Use the returned object
}

// Using ModuleManager form:
let other = ModuleManager.require("OtherModule", true);
----

'''''

=== ModuleManager Functions

The *ModuleManager* object also provides the following additional
utility functions:

==== ModuleManager.loaded

*Usage:*

[source,js]
----
let isLoaded = ModuleManager.loaded("MyModule");
----

* *Description:* Checks whether the specified module is already loaded.
If the module’s scope, value, and timestamp are present in the internal
registries, it is considered loaded.
* *Parameters:*
** _moduleName_ (string): The name (or path) of the module.
* *Return Value:*
** A numeric boolean (1 or 0), indicating whether the module is loaded.

'''''

==== ModuleManager.remove

*Usage:*

[source,js]
----
let removed = ModuleManager.remove("MyModule");
----

* *Description:* Unloads (removes) the specified module from the
internal caches. This allows a fresh load on subsequent `+import+` or
`+require+` calls. If the module is currently not loaded, the function
does nothing.
* *Parameters:*
** _moduleName_ (string): The name (or path) of the module.
* *Return Value:*
** A numeric boolean (1 or 0): 1 if a loaded module was removed, 0 if
the module was not found/loaded.

'''''

==== ModuleManager.getModuleFileTime

*Usage:*

[source,js]
----
let modTime = ModuleManager.getModuleFileTime("MyModule");
----

* *Description:* Attempts to locate and load the module file via the
registered module loader functions (without actually compiling or
executing it), then returns the file’s timestamp. If the module is not
found, an error is raised.
* *Parameters:*
** _moduleName_ (string): The name (or path) of the module to check.
* *Return Value:*
** A numeric value representing the module file’s date/time stamp.
** If no module loader can find the file, it raises an error.

'''''

=== Summary

* *Global & ModuleManager Usage:* The functions `+import+` and
`+require+` appear both in the global namespace and under
*ModuleManager*. You can call them directly, as in
`+import a, b from "SomeModule";+`, or via
`+ModuleManager.import("SomeModule", [...])+`. The `+remove+`,
`+loaded+`, and `+getModuleFileTime+` utilities are only in
*ModuleManager*.
* *Workflow:*
[arabic]
. POCA uses module loader functions to locate and read module source
code.
. The source code is compiled in a sub-context.
. The module can define its exported API either via an `+exports+` hash
(ECMAScript-like) or via a final `+return+` object (Lua-like).
. `+import+` selectively brings symbols into the local scope, while
`+require+` returns the exported object.
. The loaded module’s scope, value, and timestamp are cached in three
global hashes.
. Optional reloading logic checks timestamps if requested.
* *Usage:* This comprehensive API lets you create modular POCA
codebases. You can share or isolate functionality across multiple script
files and decide whether to adopt ECMAScript-like or Lua-like styles for
exporting symbols. The `+ModuleManager+` object and the global
`+import/require+` calls provide powerful ways to structure and reuse
code in a dynamic, typeless environment.
* *Note:* The `+import+` and `+require+` functions should not be used 
in the POCA REPL (Read-Eval-Print Loop) environment, as they are
not designed for interactive use. They are intended for use in
script files or modules where you can define and manage dependencies
and imports in a structured manner.

== Number

=== Overview

The POCA Number API provides methods for converting number literals into
string representations with various formatting options. These methods
are available on Number literals and allow you to represent numbers in
standard, exponential, fixed, precision, and different radix formats.

'''''

=== Global Number Object

The global *Number* object provides a set of native functions that
operate on number literals. These functions are registered in the Number
hash and can be invoked directly on any number literal.

==== Number.create

*Usage:*
[source,js]
----
let num = Number.create(value, radix);
----

or equivalently,

[source,js]
----
let num = new Number(value, radix);
----

or
[source,js]
----
let num = 123.456;
----

* *Description:* `+Number.create()+` or `+new Number()+` creates a new
number by invoking the underlying number creation routine. The resulting
value represents a number literal, which is registered for subsequent
number operations. The `+new Number()+` syntax is equivalent to
`+Number.create()+`.

* *Parameters:*
** `+value+` (number): The numeric value to be created, or a string
representation of a number, which can be in decimal, hexadecimal 
(prefixed with `0x`), octal (prefixed with `0o`) or binary (prefixed 
with `0b`) format or any other valid number string.
** `+radix+` (number, optional): The base for numeral system
(2 for binary, 8 for octal, 10 for decimal, 16 for hexadecimal), 
default is 10. 
* *Return Value:* A number literal representing the specified value.
* *Example:*
+
[source,js]
----
// Create a number using the factory function.
let num1 = Number.create(123.456);
let num2 = new Number(123.456); // Equivalent to Number.create()
let num3 = 123.456; // Using literal syntax
let num4 = Number.create("123.456", 10); // String to number conversion
let num5 = new Number("ff", 16); // Hexadecimal to number
let num6 = Number.create("100", 2); // Binary to number
let num7 = new Number("0xff"); // Hexadecimal to number
let num8 = Number.create("0b1010"); // Binary to number
let num7 = Number.create("0xff.8"); // Floating-point hex to number
let num8 = new Number("0b1010.1"); // Floating-point binary to number
----
* *Note:* The `+new Number()+` syntax is equivalent to `+Number.create()+`

=== Number Instance

==== Number.toString

*Usage:*

[source,js]
----
let str = (123.456).toString();
----

* *Description:* Returns the string representation of the number.
* *Parameters:* None.
* *Return Value:* A string representing the number.
* *Example:*
+
[source,js]
----
let str = (123.456).toString();
puts(str); // "123.456"
----

'''''

==== Number.toExponential

*Usage:*

[source,js]
----
let expStr = (123.456).toExponential(3);
----

* *Description:* Converts the number to its exponential notation. The
argument specifies the number of digits after the decimal point.
* *Parameters:*
** `+precision+` (number): The number of digits after the decimal point 
plus. If it is -1, then the full representation is used. 
* *Return Value:* A string representing the number in exponential
notation.
* *Example:*
+
[source,js]
----
let expStr = (123.456).toExponential(2);
puts(expStr); // e.g., "1.23e+2"
----

'''''

==== Number.toFixed

*Usage:*

[source,js]
----
let fixedStr = (123.456).toFixed(2);
----

* *Description:* Returns a string representation of the number in
fixed-point notation. The argument specifies the number of decimal
places.
* *Parameters:*
** `+decimalPlaces+` (number): The number of digits after the decimal
point.
* *Return Value:* A string representing the number in fixed-point
format.
* *Example:*
+
[source,js]
----
let fixedStr = (123.456).toFixed(2);
puts(fixedStr); // "123.46"
----

'''''

==== Number.toPrecision

*Usage:*

[source,js]
----
let precStr = (123.456).toPrecision(5);
----

* *Description:* Returns a string representation of the number with the
specified number of significant digits.
* *Parameters:*
** `+precision+` (number): The total number of significant digits.
* *Return Value:* A string representing the number with the given
precision.
* *Example:*
+
[source,js]
----
let precStr = (123.456).toPrecision(5);
puts(precStr); // "123.46" (format may vary)
----

'''''

==== Number.toRadix

*Usage:*

[source,js]
----
let radixStr = (255).toRadix(16);
----

* *Description:* Converts the number to a string in the numeral system
of the specified radix. The argument determines the radix (base) to use
for conversion.
* *Parameters:*
** `+radix+` (number): The base for the numeral system (e.g., 2 for
binary, 16 for hexadecimal).
* *Return Value:* A string representing the number in the specified
radix.
* *Example:*
+
[source,js]
----
let radixStr = (255).toRadix(16);
puts(radixStr); // "ff"
----

'''''

=== Summary

* *Global Object:* The Number object provides methods that operate on
number literals. These methods convert numbers into various string
representations.
* *Number Methods:*
** *toString:* Returns the standard string representation of a number.
** *toExponential:* Converts a number into exponential notation with a
specified precision.
** *toFixed:* Formats a number using fixed-point notation.
** *toPrecision:* Formats a number with a specified number of
significant digits.
** *toRadix:* Converts a number to a string in a specified numeral
system.
* *Usage:* This comprehensive API lets you format number literals in
POCA with flexibility similar to JavaScript, providing robust options
for numeric string representation in a dynamic, typeless environment.

== Path

=== Overview

The POCA Path API provides a variety of functions for manipulating file
system paths. These functions allow you to extract directories, file
names, file extensions, and perform path transformations (such as
converting to relative or absolute paths), split or join path
components, and perform file system operations (like creating
directories, checking file existence, and copying or moving files). This
API works with both Windows and Unix-style paths.

'''''

==== Path.dir

*Usage:*

[source,js]
----
let directory = Path.dir(path);
----

* *Parameters:*
** `+path+` (string): The full file path.
* *Description:* Returns the directory portion of a path, excluding the
file name and any trailing delimiter.
* *Return Value:* A new string containing the directory portion.
* *Example:*

[source,js]
----
let dir = Path.dir("/folder/file.txt");
// Returns "/folder"
----

'''''

==== Path.fileName

*Usage:*

[source,js]
----
let name = Path.fileName(path);
----

* *Parameters:*
** `+path+` (string): The full file path.
* *Description:* Extracts and returns the file name from the given path.
* *Return Value:* A new string containing the file name.
* *Example:*

[source,js]
----
let fileName = Path.fileName("/folder/file.txt");
// Returns "file.txt"
----

'''''

==== Path.fileExtension

*Usage:*

[source,js]
----
let ext = Path.fileExtension(path);
----

* *Parameters:*
** `+path+` (string): The full file path.
* *Description:* Returns the file extension from the given path.
* *Return Value:* A new string with the file extension.
* *Example:*

[source,js]
----
let extension = Path.fileExtension("/folder/file.txt");
// Returns ".txt"
----

'''''

==== Path.currentScriptFile

*Usage:*

[source,js]
----
let currentScript = Path.currentScriptFile(absolute);
----

* *Parameters:*
** `+absolute+` (boolean, optional):
*** `+true+`: Return an absolute file path.
*** `+false+` (or omitted): Return a relative file path.
* *Description:* Returns the current script file name. The boolean flag
determines whether the returned path is absolute or relative.
* *Return Value:* A new string representing the current script file
name.
* *Example:*

[source,js]
----
let scriptPath = Path.currentScriptFile(true);
// Returns the absolute path of the current script file (e.g., "/home/user/project/script.poca")
----

'''''

==== Path.relative

*Usage:*

[source,js]
----
let relativePath = Path.relative(targetPath, basePath);
----

* *Parameters:*
** `+targetPath+` (string): The path to be converted.
** `+basePath+` (string, optional): The base path to compare against
(default is empty string).
* *Description:* Converts a given path to a relative path based on an
optional base path.
* *Return Value:* A new string containing the relative path.
* *Example:*

[source,js]
----
let relPath = Path.relative("/folder/subfolder/file.txt", "/folder");
// Returns "subfolder/file.txt"
----

'''''

==== Path.absolute

*Usage:*

[source,js]
----
let absolutePath = Path.absolute(relativePath, basePath);
----

* *Parameters:*
** `+relativePath+` (string): The relative path.
** `+basePath+` (string, optional): The base path to expand from
(default is empty string).
* *Description:* Converts a relative path to an absolute path using an
optional base path.
* *Return Value:* A new string with the absolute path.
* *Example:*

[source,js]
----
let absPath = Path.absolute("subfolder/file.txt", "/folder");
// Returns "/folder/subfolder/file.txt"
----

'''''

==== Path.split

*Usage:*

[source,js]
----
let parts = Path.split(path);
----

* *Parameters:*
** `+path+` (string): The file path to split.
* *Description:* Splits a path string into its component parts, removing
any empty segments.
* *Return Value:* An array of strings representing each part of the
path.
* *Example:*

[source,js]
----
let segments = Path.split("/folder/subfolder/file.txt");
// Returns ["/", "folder", "subfolder", "file.txt"]
----

'''''

==== Path.join

*Usage:*

[source,js]
----
let fullPath = Path.join(pathList);
----

* *Parameters:*
** `+pathList+` (array): An array of path segments.
* *Description:* Joins an array of path segments into a single path
string, using the platform-specific delimiter.
* *Return Value:* A new string with the combined path.
* *Example:*

[source,js]
----
let pathJoined = Path.join(["/", "folder", "file.txt"]);
// Returns "/folder/file.txt"
----

'''''

==== Path.isAbsolute

*Usage:*

[source,js]
----
let isAbs = Path.isAbsolute(path);
----

* *Parameters:*
** `+path+` (string): The file path to check.
* *Description:* Checks whether a given path is absolute.
* *Return Value:* A numeric boolean: `+1+` if the path is absolute,
`+0+` otherwise.
* *Example:*

[source,js]
----
let absoluteCheck = Path.isAbsolute("/folder/file.txt");
// Returns 1
----

'''''

==== Path.delimiter

*Usage:*

[source,js]
----
let delim = Path.delimiter();
----

* *Parameters:* None.
* *Description:* Returns the directory delimiter character for the
platform (forward slash on Unix, backslash on Windows).
* *Return Value:* A new string containing the delimiter.
* *Example:*

[source,js]
----
let delimiter = Path.delimiter();  // Returns "/" on Unix or "\" on Windows.
----

'''''

==== Path.current

*Usage:*

[source,js]
----
let currDir = Path.current();
----

* *Parameters:* None.
* *Description:* Returns the current working directory.
* *Return Value:* A new string with the current directory path.
* *Example:*

[source,js]
----
let currentDirectory = Path.current();
// Returns, for example, "/home/user/project"
----

'''''

==== Path.getEntries

*Usage:*

[source,js]
----
let entries = Path.getEntries(dirPath);
----

* *Parameters:*
** `+dirPath+` (string): The directory path.
* *Description:* Retrieves an array of directory entry names (files and
subdirectories) from the specified directory.
* *Return Value:* An array of strings representing the directory
entries.
* *Example:*

[source,js]
----
let dirEntries = Path.getEntries("/usr/local/bin");
// Returns an array of file and directory names.
----

'''''

==== Path.stat

*Usage:*

[source,js]
----
let stats = Path.stat(path);
----

* *Parameters:*
** `+path+` (string): The file or directory path.
* *Description:* Retrieves a hash containing file or directory
statistics. The hash includes keys such as:
** `+size+`: File size in bytes.
** `+mtime+`: Modification time.
** `+ctime+`: Creation time.
** `+atime+`: Access time.
** `+type+`: A string indicating the type (e.g., `+"file"+` or
`+"directory"+`).
** `+symlink+`: A numeric boolean (`+0+` or `+1+`) indicating whether
the path is a symbolic link.
+
*Note:* The time values are returned as Object Pascal TDateTime values
(64-bit doubles compatible with Delphi/FreePascal), not as Unix
timestamps.
* *Return Value:* A hash with keys `+size+`, `+mtime+`, `+ctime+`,
`+atime+`, `+type+`, and `+symlink+`.
* *Example:*

[source,js]
----
let fileStats = Path.stat("/folder/file.txt");
// Returns a hash like: { size: 1024, mtime: 44500.1234, ctime: 44400.5678, atime: 44500.1234, type: "file", symlink: 0 }
----

'''''

==== Path.isDir

*Usage:*

[source,js]
----
let isDirectory = Path.isDir(path);
----

* *Parameters:*
** `+path+` (string): The path to check.
* *Description:* Checks if the given path represents a directory.
* *Return Value:* A numeric boolean: `+1+` if it is a directory, `+0+`
otherwise.
* *Example:*

[source,js]
----
let dirCheck = Path.isDir("/folder");
// Returns 1 if "/folder" is a directory.
----

'''''

==== Path.isFile

*Usage:*

[source,js]
----
let isFile = Path.isFile(path);
----

* *Parameters:*
** `+path+` (string): The path to check.
* *Description:* Checks if the given path represents a file.
* *Return Value:* A numeric boolean: `+1+` if it is a file, `+0+`
otherwise.
* *Example:*

[source,js]
----
let fileCheck = Path.isFile("/folder/file.txt");
// Returns 1 if it is a file.
----

'''''

==== Path.isSymLink

*Usage:*

[source,js]
----
let isLink = Path.isSymLink(path);
----

* *Parameters:*
** `+path+` (string): The path to check.
* *Description:* Checks if the given path is a symbolic link.
* *Return Value:* A numeric boolean: `+1+` if it is a symlink, `+0+`
otherwise.
* *Example:*

[source,js]
----
let symlinkCheck = Path.isSymLink("/usr/local/bin/symlink");
// Returns 1 if it is a symbolic link.
----

'''''

==== Path.resolve

*Usage:*

[source,js]
----
let resolved = Path.resolve(path);
----

* *Parameters:*
** `+path+` (string): The path to resolve.
* *Description:* Resolves the target of a symbolic link. If the given
path is a symlink, returns the target path.
* *Return Value:* A new string representing the resolved path.
* *Example:*

[source,js]
----
let targetPath = Path.resolve("/usr/local/bin/symlink");
// Returns the target path of the symlink.
----

'''''

==== Path.mkdir

*Usage:*

[source,js]
----
let created = Path.mkdir(path);
----

* *Parameters:*
** `+path+` (string): The directory path to create.
* *Description:* Creates a new directory at the specified path. If the
directory already exists, nothing is done.
* *Return Value:* A numeric boolean: `+1+` if the directory was created
successfully, `+0+` otherwise.
* *Example:*

[source,js]
----
let success = Path.mkdir("/newFolder");
// Returns 1 if created successfully.
----

'''''

==== Path.chdir

*Usage:*

[source,js]
----
let changed = Path.chdir(path);
----

* *Parameters:*
** `+path+` (string): The directory path to change to.
* *Description:* Changes the current working directory to the specified
path.
* *Return Value:* A numeric boolean: `+1+` if the directory was changed
successfully, `+0+` otherwise.
* *Example:*

[source,js]
----
let changeResult = Path.chdir("/folder");
// Returns 1 on success.
----

'''''

==== Path.rmdir

*Usage:*

[source,js]
----
let removed = Path.rmdir(path);
----

* *Parameters:*
** `+path+` (string): The directory path to remove.
* *Description:* Removes the specified directory if it exists.
* *Return Value:* A numeric boolean: `+1+` if removed successfully,
`+0+` otherwise.
* *Example:*

[source,js]
----
let removalStatus = Path.rmdir("/folder");
// Returns 1 if the directory was removed.
----

'''''

==== Path.exist

*Usage:*

[source,js]
----
let exists = Path.exist(path);
----

* *Parameters:*
** `+path+` (string): The file or directory path to check.
* *Description:* Checks if a file or directory exists at the specified
path.
* *Return Value:* A numeric boolean: `+1+` if it exists, `+0+`
otherwise.
* *Example:*

[source,js]
----
let existence = Path.exist("/folder/file.txt");
// Returns 1 if the path exists.
----

'''''

==== Path.remove

*Usage:*

[source,js]
----
let success = Path.remove(path);
----

* *Parameters:*
** `+path+` (string): The file path to delete.
* *Description:* Deletes a file at the specified path.
* *Return Value:* A numeric boolean: `+1+` if deletion was successful,
`+0+` otherwise.
* *Example:*

[source,js]
----
let deleteResult = Path.remove("/folder/file.txt");
// Returns 1 if deletion succeeded.
----

'''''

==== Path.copy

*Usage:*

[source,js]
----
let success = Path.copy(sourcePath, destinationPath);
----

* *Parameters:*
[arabic]
. `+sourcePath+` (string): The source file path.
. `+destinationPath+` (string): The destination file path.
* *Description:* Copies a file from the source path to the destination
path.
* *Return Value:* A numeric boolean: `+1+` if the file was copied
successfully, `+0+` otherwise.
* *Example:*

[source,js]
----
let copyResult = Path.copy("/folder/source.txt", "/folder/dest.txt");
// Returns 1 on success.
----

'''''

==== Path.move

*Usage:*

[source,js]
----
let success = Path.move(sourcePath, destinationPath);
----

* *Parameters:*
[arabic]
. `+sourcePath+` (string): The source file path.
. `+destinationPath+` (string): The destination file path.
* *Description:* Moves a file from the source path to the destination
path.
* *Return Value:* A numeric boolean: `+1+` if the move was successful,
`+0+` otherwise.
* *Example:*

[source,js]
----
let moveResult = Path.move("/folder/source.txt", "/folder/dest.txt");
// Returns 1 on success.
----

'''''

==== Path.rename

*Usage:*

[source,js]
----
let success = Path.rename(sourcePath, newPath);
----

* *Parameters:*
[arabic]
. `+sourcePath+` (string): The current file path.
. `+newPath+` (string): The new file path.
* *Description:* Renames a file from the current file path to the new
file path.
* *Return Value:* A numeric boolean: `+1+` if renaming was successful,
`+0+` otherwise.
* *Example:*

[source,js]
----
let renameResult = Path.rename("/folder/old.txt", "/folder/new.txt");
// Returns 1 if renaming succeeded.
----

'''''

=== Summary

* *Global Object:* The *Path* object provides a comprehensive API for
working with file system paths. It enables you to extract and manipulate
path components, determine path properties, and perform file system
operations.
* *Path API Functions:*
** *Path.dir:* Extracts the directory portion of a path.
** *Path.fileName:* Retrieves the file name from a path.
** *Path.fileExtension:* Retrieves the file extension.
** *Path.currentScriptFile:* Returns the current script file name, with
a boolean flag (`+absolute+`) indicating whether the path is absolute
(`+true+`) or relative (`+false+`).
** *Path.relative:* Converts a path to a relative form based on an
optional base.
** *Path.absolute:* Converts a relative path to an absolute one using an
optional base.
** *Path.split:* Splits a path into its component parts.
** *Path.join:* Joins an array of path segments into a single path.
** *Path.isAbsolute:* Checks if a path is absolute.
** *Path.delimiter:* Returns the path delimiter for the platform.
** *Path.current:* Returns the current working directory.
** *Path.getEntries:* Returns an array of directory entries from a given
directory.
** *Path.stat:* Retrieves file/directory statistics in a hash.
** *Path.isDir:* Checks if a path represents a directory.
** *Path.isFile:* Checks if a path represents a file.
** *Path.isSymLink:* Checks if a path is a symbolic link.
** *Path.resolve:* Resolves a symbolic link to its target path.
** *Path.mkdir:* Creates a new directory.
** *Path.chdir:* Changes the current working directory.
** *Path.rmdir:* Removes a directory.
** *Path.exist:* Checks if a file or directory exists.
** *Path.remove:* Deletes a file.
** *Path.copy:* Copies a file.
** *Path.move:* Moves a file.
** *Path.rename:* Renames a file.
* *Usage:* The POCA Path API lets you handle file system paths and
perform file operations easily in your POCA scripts. Whether you need to
manipulate path strings or interact with the file system (e.g., create
directories, check file existence, copy or move files), this
comprehensive API provides the necessary functionality in a dynamic,
typeless environment.
* *Note:* The Path API is designed to work with both Windows and Unix
file systems, making it versatile for cross-platform development. The
API handles path delimiters and file operations in a consistent way,
allowing you to write scripts that can run on different operating
systems without modification.

== RegExp

=== Overview

The POCA RegExp API brings powerful pattern matching to your POCA
scripts. Regular expressions in POCA are dynamic, typeless objects
(ghost objects) backed by a native engine. You can create these objects
either by using a global RegExp factory or by using the native literal
syntax (similar to JavaScript). Once created, RegExp ghost objects
expose methods for executing, testing, finding, matching, splitting, and
replacing text.

'''''

=== Global RegExp Object

The global *RegExp* object serves as both a factory and a namespace for
regular expression operations. It provides methods to create and
manipulate regular expressions before they are used in pattern matching.

==== RegExp.create, RegExp.compile, and the new Operator

*Usage:*

[source,js]
----
let re = new RegExp("foo(bar)?");
----

or equivalently,

[source,js]
----
let re = RegExp.create("foo(bar)?");
----

or

[source,js]
----
let re = RegExp.compile("foo(bar)?");
----

* *Description:* These functions compile the provided pattern into a
RegExp ghost object. The function accepts a plain string (or, if given a
RegExp ghost object, its source pattern is used) and compiles it after
checking its UTF-8 status. The resulting ghost object is registered in
the global RegExp hash so that its methods become available dynamically.
In POCA, the `+new+` operator is simply an alias for
`+RegExp.create+`—there is no separate constructor.
* *Parameters:*
** `+pattern+` (string): The regular expression pattern to compile.
* *Return Value:* A RegExp ghost object that encapsulates the compiled
pattern and supports regex operations.
* *Examples:*
+
[source,js]
----
// Using the new operator (alias for RegExp.create):
let re1 = new RegExp("foo(bar)?");

// Using RegExp.create:
let re2 = RegExp.create("foo(bar)?");

// Using RegExp.compile:
let re3 = RegExp.compile("foo(bar)?");
----

==== RegExp.escape

*Usage:*

[source,js]
----
let safePattern = RegExp.escape(pattern);
----

* *Description:* Escapes all regex metacharacters in the provided string
so that it can be safely used as a literal pattern. Special characters
(such as `+(+`, `+|+`, `+.+`, `+*+`, `+?+`, `+^+`, `+$+`, `+-+`, `+[+`,
`+{+`, `+}+`, `+]+`, `+)+`, `+\+`) are prefixed with a backslash.
* *Parameters:*
** `+pattern+` (string): The input string whose special characters
should be escaped.
* *Return Value:* A new string with all regex metacharacters escaped.
* *Example:*
+
[source,js]
----
let safe = RegExp.escape("(test)*");
puts(safe); // Outputs: \(test\)\*
----

'''''

=== Native Literal Syntax

POCA supports a native regular expression literal syntax similar to
JavaScript. When you enclose a pattern between forward slashes, it is
automatically compiled into a RegExp ghost object.

* *Example:*
+
[source,js]
----
let reLiteral = /foo(bar)?/;
// This is equivalent to:
let reLiteral2 = RegExp.compile("foo(bar)?");
----

_Note:_ Both the literal syntax and the factory methods produce ghost
objects that offer the same methods for regex operations.

'''''

=== Methods on RegExp Ghost Objects

Once you have a RegExp ghost object (for example, from
`+RegExp.create+`, `+RegExp.compile+`, or literal syntax), you can use
its methods to perform various regex operations on strings.

==== RegExp.exec

*Usage:*

[source,js]
----
let result = re.exec(input, start, limit);
----

* *Description:* Executes the regular expression on the given input
string. Returns an array of capture results for each match found.
** If the regular expression uses named groups (flagged with
`+rfNAMED+`), each match is returned as a hash mapping group names to
capture details.
** Otherwise, each match is represented as an array containing:
*** The starting code point of the match.
*** The length of the match.
*** The captured substring.
* *Parameters:*
** `+input+` (string): The string to search.
** `+start+` (number): The starting code unit in the string (defaults to
1 if not specified).
** `+limit+` (number): The maximum number of matches to process
(defaults to 1 if not specified).
* *Return Value:* An array of capture results or null if no match is
found.
* *Example:*
+
[source,js]
----
let captures = re.exec("user@example.com", 1);
// 'captures' contains details for each capture group found in the match.
----

'''''

==== RegExp.test

*Usage:*

[source,js]
----
let isMatch = re.test(input, start);
----

* *Description:* Tests whether the regular expression matches the input
string starting from the given position.
* *Parameters:*
** `+input+` (string): The string to test.
** `+start+` (number): The starting code unit (defaults to 1 if not
specified).
* *Return Value:* A numeric boolean value (1 for true, 0 for false).
* *Example:*
+
[source,js]
----
if (re.test("user@example.com", 1)) {
  puts("Email format is valid.");
}
----

'''''

==== RegExp.find

*Usage:*

[source,js]
----
let position = re.find(input, start);
----

* *Description:* Finds the first occurrence of a match in the input
string starting from the specified code unit.
* *Parameters:*
** `+input+` (string): The string in which to search.
** `+start+` (number): The starting code unit (defaults to 1 if not
specified).
* *Return Value:* The starting code point of the first match or a
special indicator if no match is found.
* *Example:*
+
[source,js]
----
let pos = re.find("The quick brown fox", 1);
----

'''''

==== RegExp.match

*Usage:*

[source,js]
----
let matches = re.match(input, start, limit);
----

* *Description:* Returns an array of matches for the regular expression
in the input string.
** For regexes with named groups, each match is returned as a hash
mapping group names to the captured substrings.
** Otherwise, each match is returned as an array of captured substrings.
* *Parameters:*
** `+input+` (string): The input string.
** `+start+` (number): The starting code unit (defaults to 1 if not
specified).
** `+limit+` (number): The maximum number of matches (defaults to 1 if
not specified).
* *Return Value:* An array of matches or null if there are no matches.
* *Example:*
+
[source,js]
----
let allMatches = re.match("user@example.com", 1, 1);
----

'''''

==== RegExp.split

*Usage:*

[source,js]
----
let parts = re.split(input, start, limit);
----

* *Description:* Splits the input string at each occurrence where the
regular expression matches.
* *Parameters:*
** `+input+` (string): The string to split.
** `+start+` (number): The starting code unit (defaults to 1 if not
specified).
** `+limit+` (number): The maximum number of splits (defaults to -1,
meaning no limit).
* *Return Value:* An array of substrings resulting from the split.
* *Example:*
+
[source,js]
----
let tokens = re.split("a,b,c", 1, -1);
----

'''''

==== RegExp.replace

*Usage:*

[source,js]
----
let resultString = re.replace(input, replacement, start, limit);
----

* *Description:* Replaces occurrences of the regular expression in the
input string with the given replacement string.
* *Parameters:*
** `+input+` (string): The string to search.
** `+replacement+` (string): The string to replace each match.
** `+start+` (number): The starting code unit (defaults to 1 if not
specified).
** `+limit+` (number): The maximum number of replacements (defaults to
-1, meaning no limit).
* *Return Value:* A new string with the replacements applied.
* *Example:*
+
[source,js]
----
let result = re.replace("Hello World", "Universe", 1, -1);
----

'''''

=== Summary

* *Global Object:* The *RegExp* object is both a factory and a namespace
for regular expressions in POCA.
** *RegExp.create* and *RegExp.compile* compile a pattern into a ghost
object.
** The `+new+` operator is an alias for `+RegExp.create+` (there is no
separate constructor).
** *RegExp.escape* produces a safe, escaped version of a string for
literal pattern matching.
** Native regex literal syntax (e.g., `+/pattern/+`) is supported.
* *RegExp Ghost Object Methods:* Once created, RegExp objects provide
the following methods:
** *exec:* Executes the pattern and returns detailed capture results.
** *test:* Checks if the input string matches the pattern.
** *find:* Retrieves the starting position of the first match.
** *match:* Collects an array of matches.
** *split:* Divides the input string based on match positions.
** *replace:* Replaces matched portions with a replacement string.

This comprehensive API lets you perform all common regex operations in a
dynamic, typeless environment, making pattern matching and text
manipulation both flexible and powerful in your POCA projects.

== Semaphore

=== Overview

The POCA Semaphore API provides counting semaphore mechanisms for
synchronizing access to shared resources in concurrent POCA scripts.
Semaphores in POCA are dynamic, typeless ghost objects created via a
factory function. With this API, you can control access to resources by
decrementing (down) or incrementing (up) the semaphore count.

'''''

=== Global Semaphore Object

The global *Semaphore* object serves as both a factory and a namespace
for semaphore operations. You can create semaphore ghost objects using
either of the following variants:

==== Semaphore.create(), or new Semaphore()

*Usage:*

[source,js]
----
let sem = Semaphore.create();
----

or equivalently,

[source,js]
----
let sem = new Semaphore();
----

* *Description:* `+Semaphore.create()+` or `+new Semaphore()+` creates a
new semaphore ghost object by invoking the underlying semaphore creation
routine. The resulting ghost object represents a counting semaphore,
which is registered for subsequent semaphore operations.
* *Parameters:* None.
* *Return Value:* A semaphore ghost object that can be used to control
access to shared resources.
* *Example:*
+
[source,js]
----
// Create a new semaphore using either syntax.
let sem1 = Semaphore.create();
let sem2 = new Semaphore();
----

'''''

=== Methods on Semaphore Ghost Objects

Once created, a semaphore ghost object provides the following methods:

==== Semaphore.down

*Usage:*

[source,js]
----
sem.down();
----

* *Description:* Decrements the semaphore count, effectively acquiring a
resource. If the semaphore count is zero, the calling thread may block
until a resource is released. The garbage collector is unlocked while
waiting for the semaphore.
* *Parameters:* None.
* *Return Value:* A null value (the function does not return a
meaningful value).
* *Example:*
+
[source,js]
----
// Acquire a semaphore slot.
sem.down();
----

'''''

==== Semaphore.up

*Usage:*

[source,js]
----
sem.up();
----

* *Description:* Increments the semaphore count, releasing a resource.
This operation signals the semaphore to allow waiting threads to
proceed.
* *Parameters:* None.
* *Return Value:* A null value.
* *Example:*
+
[source,js]
----
// Release a semaphore slot.
sem.up();
----

'''''

=== Summary

* *Global Object:* The Semaphore object acts as a factory for creating
semaphore ghost objects. `+Semaphore.create()+` or `+new Semaphore()+`
creates a new semaphore ghost object by invoking the underlying
semaphore creation routine. The resulting ghost object represents a
counting semaphore, which is registered for subsequent semaphore
operations.
* *Semaphore Ghost Object Methods:* Once created, semaphore ghost
objects provide the following methods to manage access:
** *down:* Decrements the semaphore count (acquires a resource).
** *up:* Increments the semaphore count (releases a resource).
* *Usage:* Semaphores enable you to synchronize access to shared
resources in concurrent POCA scripts by controlling how many execution
contexts can access a resource simultaneously.

This comprehensive API lets you incorporate semaphore mechanisms into
your POCA projects, providing essential synchronization for concurrent
execution.

== String

=== Overview

The POCA String API provides a rich set of operations for manipulating
strings in POCA scripts. Strings in POCA are a native type (not ghost
objects) that support extensive methods for inspection, conversion,
searching, and modification. You can create string values using string
literal syntax (using double quotes `+""+` or single quotes `+''+`) or
by using the global String object via factory functions such as
`+String.create()+` or `+new String()+`.

Strings in POCA are always UTF-8 encoded, and the API provides methods for
working with both code points and code units. The API includes methods
for counting code points, converting strings to numbers, checking for
substring presence, splitting strings, trimming whitespace, and more.
But POCA's UTF-8 decoder fallbacks to Latin-1 if it detects an invalid
UTF-8 sequence at a code unit boundary. This allows you to work with
strings that may contain invalid UTF-8 sequences without raising
problems. And it allows you to use the same string API for both UTF-8 and
Latin-1 strings, and even mixed strings containing both encodings.

In contrast, JavaScript/ECMAScript strings are UTF-16 encoded, which can
lead to issues when working with characters outside the Basic Multilingual 
Plane (BMP). POCA strings are always UTF-8 encoded, which means they can 
handle a wider range of characters without the complications of surrogate 
pairs. This makes POCA strings more straightforward to work with, especially 
for internationalization and localization.

* *Note:* The POCA String API is designed to be similar to JavaScript's
String API, but it also includes some Lua-like features. This
combination provides a familiar yet powerful string manipulation
experience for developers coming from both JavaScript and Lua
environments.

'''''

=== Global String Object

The global *String* object serves as both a factory and a namespace for
string operations. You can create string values using any of the
following variants:

==== String.create(), new String(), or Literal Syntax

*Usage:*

[source,js]
----
let str1 = String.create("Hello, POCA!");
----

or equivalently,

[source,js]
----
let str2 = new String("Hello, POCA!");
----

or simply using literals:

[source,js]
----
let str3 = "Hello, POCA!";
let str4 = 'Hello, POCA!';
----

* *Description:* `+String.create()+`, `+new String()+`, or using literal
syntax creates a new string value by invoking the underlying string
creation routine. The resulting value represents the given sequence of
characters and is available for subsequent string operations.
* *Parameters:* A string value (if provided) used to initialize the
string.
* *Return Value:* A new string value.
* *Example:*
+
[source,js]
----
// Using factory functions:
let greeting = String.create("Hello, World!");
let farewell = new String("Goodbye!");

// Using literal syntax:
let literalStr1 = "Literal String";
let literalStr2 = 'Another Literal';
----

'''''

=== API Functions

Below is a detailed description of every API function available for
strings in POCA.

==== String.countCodePoints

*Usage:*

[source,js]
----
let count = "example".countCodePoints();
----

* *Description:* Returns the number of Unicode code points in the
string. If the string is encoded as UTF‑8, the function returns the
UTF‑8 length; otherwise, it returns the raw length.
* *Parameters:* None.
* *Return Value:* A numeric value representing the number of code
points.

'''''

==== String.countCodeUnits

*Usage:*

[source,js]
----
let count = "example".countCodeUnits();
----

* *Description:* Returns the number of code units (raw characters) in
the string.
* *Parameters:* None.
* *Return Value:* A numeric value representing the number of code units.

'''''

==== String.length

*Usage:*

[source,js]
----
let len = "example".length();
----

* *Description:* Returns the length of the string. For UTF‑8 strings,
this is the number of Unicode code points; otherwise, it is the raw
character count.
* *Parameters:* None.
* *Return Value:* A numeric value representing the length.

'''''

==== String.toNumber

*Usage:*

[source,js]
----
let num = "123.45".toNumber();
----

* *Description:* Converts the string to a numeric value. An optional
precision argument may be provided to control the conversion precision.
* *Parameters:*
** _precision_ (optional, number): The number of digits to consider.
* *Return Value:* A numeric value representing the converted number, or
null if conversion fails.

'''''

==== String.toString

*Usage:*

[source,js]
----
let s = "Hello".toString();
----

* *Description:* Returns the string itself. This function is useful for
explicit conversion.
* *Parameters:* None.
* *Return Value:* The string value.

'''''

==== String.includes

*Usage:*

[source,js]
----
if ("Hello, World!".includes("World")) {
  puts("Found!");
}
----

* *Description:* Checks whether the string contains the specified
substring.
* *Parameters:*
** _substring_ (string): The string to search for.
* *Return Value:* A numeric boolean value: `+1+` if found, `+0+`
otherwise.

'''''

==== String.indexOf

*Usage:*

[source,js]
----
let idx = "Hello, World!".indexOf("World");
----

* *Description:* Returns the index (0-based) of the first occurrence of
the specified substring. If not found, returns -1.
* *Parameters:*
** _substring_ (string): The substring to search for.
* *Return Value:* A numeric index (0-based), or -1 if the substring is
not found.

'''''

==== String.lastIndexOf

*Usage:*

[source,js]
----
let idx = "Hello, World! Hello!".lastIndexOf("Hello");
----

* *Description:* Returns the index (0-based) of the last occurrence of
the specified substring. If not found, returns -1.
* *Parameters:*
** _substring_ (string): The substring to search for.
* *Return Value:* A numeric index (0-based), or -1 if the substring is
not found.

'''''

==== String.split

*Usage:*

[source,js]
----
let parts = "a,b,c".split(",");
----

* *Description:* Splits the string into an array of substrings using the
specified delimiter.
* *Parameters:*
** _delimiter_ (string): The string used to split the text.
* *Return Value:* An array of strings.

'''''

==== String.trim

*Usage:*

[source,js]
----
let trimmed = "  Hello  ".trim();
----

* *Description:* Returns a new string with whitespace removed from both
ends.
* *Parameters:* None.
* *Return Value:* A string with leading and trailing whitespace removed.

'''''

==== String.trimLeft

*Usage:*

[source,js]
----
let trimmed = "  Hello".trimLeft();
----

* *Description:* Returns a new string with whitespace removed from the
beginning (left side).
* *Parameters:* None.
* *Return Value:* A string with left-side whitespace removed.

'''''

==== String.trimRight

*Usage:*

[source,js]
----
let trimmed = "Hello  ".trimRight();
----

* *Description:* Returns a new string with whitespace removed from the
end (right side).
* *Parameters:* None.
* *Return Value:* A string with right-side whitespace removed.

'''''

==== String.toLowerCase

*Usage:*

[source,js]
----
let lower = "HeLLo".toLowerCase();
----

* *Description:* Converts the string to lower case.
* *Parameters:* None.
* *Return Value:* A new string in lower case.

'''''

==== String.toUpperCase

*Usage:*

[source,js]
----
let upper = "HeLLo".toUpperCase();
----

* *Description:* Converts the string to upper case.
* *Parameters:* None.
* *Return Value:* A new string in upper case.

'''''

==== String.substr

*Usage:*

[source,js]
----
let sub = "Hello, World!".substr(7, 5);
----

* *Description:* Extracts a substring from the string starting at the
specified index (0-based, with negative values counting from the end)
and extending for the specified length. Indices are based on Unicode
code points if the string is UTF‑8.
* *Parameters:*
** _start_ (number): The starting index.
** _length_ (number): The number of characters to extract.
* *Return Value:* A substring.

'''''

==== String.toLatin1

*Usage:*

[source,js]
----
let latin = "Some text".toLatin1();
----

* *Description:* Converts the string to Latin1 encoding. *Note:* In
strict UTF‑8 POCA builds, calling this function raises an error.
* *Parameters:* None.
* *Return Value:* A string in Latin1 encoding.

'''''

==== String.isLatin1

*Usage:*

[source,js]
----
let check = "Some text".isLatin1();
----

* *Description:* Checks if the string is in Latin1 encoding.
* *Parameters:* None.
* *Return Value:* A numeric boolean value: `+1+` if true, `+0+` if
false.

'''''

==== String.toUTF8

*Usage:*

[source,js]
----
let utf8 = "Some text".toUTF8();
----

* *Description:* Converts the string to UTF‑8 encoding.
* *Parameters:* None.
* *Return Value:* A string in UTF‑8 encoding.

'''''

==== String.isUTF8

*Usage:*

[source,js]
----
let check = "Some text".isUTF8();
----

* *Description:* Checks if the string is in UTF‑8 encoding.
* *Parameters:* None.
* *Return Value:* A numeric boolean value: `+1+` if true, `+0+` if
false.

'''''

==== String.charAt

*Usage:*

[source,js]
----
let ch = "Hello".charAt(1);
----

* *Description:* Returns the character at the specified code point index
(0-based, with negative values allowed to count from the end).
* *Parameters:*
** _index_ (number): The code point index.
* *Return Value:* A string containing the character, or null if the
index is out of bounds.

'''''

==== String.codePointAt

*Usage:*

[source,js]
----
let cp = "Hello".codePointAt(1);
----

* *Description:* Returns the Unicode code point of the character at the
specified index.
* *Parameters:*
** _index_ (number): The code point index.
* *Return Value:* A numeric value representing the Unicode code point.

'''''

==== String.codeUnitAt

*Usage:*

[source,js]
----
let cu = "Hello".codeUnitAt(1);
----

* *Description:* Returns the raw code unit (character code) at the
specified position.
* *Parameters:*
** _index_ (number): The code unit index.
* *Return Value:* A numeric value representing the code unit.

'''''

==== String.codePointToCodeUnit

*Usage:*

[source,js]
----
let unitIdx = "Hello".codePointToCodeUnit(2);
----

* *Description:* Converts a code point index to its corresponding code
unit index.
* *Parameters:*
** _index_ (number): The code point index.
* *Return Value:* A numeric value representing the code unit index.

'''''

==== String.codeUnitToCodePoint

*Usage:*

[source,js]
----
let pointIdx = "Hello".codeUnitToCodePoint(2);
----

* *Description:* Converts a code unit index to its corresponding code
point index.
* *Parameters:*
** _index_ (number): The code unit index.
* *Return Value:* A numeric value representing the code point index.

'''''

==== String.codePoints

*Usage:*

[source,js]
----
let cps = "Hello".codePoints();
----

* *Description:* Returns an array of all Unicode code points in the
string.
* *Parameters:* None.
* *Return Value:* An array of numeric code points.

'''''

==== String.codeUnits

*Usage:*

[source,js]
----
let cus = "Hello".codeUnits();
----

* *Description:* Returns an array of all code units (raw character
codes) in the string.
* *Parameters:* None.
* *Return Value:* An array of numeric code units.

'''''

==== String.concat

*Usage:*

[source,js]
----
let combined = "Hello".concat(", ", "World!");
----

* *Description:* Concatenates the string with one or more other strings.
* *Parameters:* One or more string values to concatenate.
* *Return Value:* A new string resulting from the concatenation.

'''''

==== String.repeat

*Usage:*

[source,js]
----
let repeated = "abc".repeat(3);
----

* *Description:* Returns a new string that consists of the original
string repeated a specified number of times.
* *Parameters:*
** _count_ (number): The number of times to repeat the string.
* *Return Value:* A new string.

'''''

==== String.create

*Usage:*

[source,js]
----
let s = String.create("initial value");
----

* *Description:* Creates a new string value. If no argument is provided,
an empty string is created.
* *Parameters:*
** _initialValue_ (string, optional): The string to initialize the new
value.
* *Return Value:* A new string value.

'''''

==== String.dump

*Usage:*

[source,js]
----
let info = String.dump(input);
----

* *Description:* Returns a detailed dump (debug representation) of the
input parameter. This is useful for debugging and inspecting the
internal representation of the input.
* *Parameters:* Input parameter (any type).
* *Return Value:* A string containing the dump information.

* *Example:*
+
[source,js]
----
let dumpInfo = String.dump({a: 1, b: "text", c: [1, 2, 3]});
puts(dumpInfo);
----
* *Output:*
```
{"a":1,"b":"text","c":[1,2,3]}
```
* *Note:* The output format may vary based on the input type and
implementation details. The dump function provides a human-readable
representation of the input, which can be useful for debugging and
inspecting complex data structures.

'''''

==== String.fromCodePoints

*Usage:*

[source,js]
----
let s = String.fromCodePoints(72, 101, 108, 108, 111);
----

or

[source,js]
----
let s = String.fromCodePoints([72, 101, 108, 108, 111]);
----

* *Description:* Creates a new string from a sequence (or array) of
Unicode code points.
* *Parameters:* One or more numeric code points, or an array of code
points.
* *Return Value:* A new string constructed from the provided code
points.

'''''

==== String.fromCodeUnits

*Usage:*

[source,js]
----
let s = String.fromCodeUnits(72, 101, 108, 108, 111);
----

or

[source,js]
----
let s = String.fromCodeUnits([72, 101, 108, 108, 111]);
----

* *Description:* Creates a new string from a sequence (or array) of code
units.
* *Parameters:* One or more numeric code units, or an array of code
units.
* *Return Value:* A new string constructed from the provided code units.

'''''

=== Summary

* *Global Object:* The String object acts as a factory for creating
string values. `+String.create()+`, `+new String()+`, or using string
literals (`+""+` or `+''+`) creates a new string value by invoking the
underlying string creation routine. The resulting value represents the
text and is available for subsequent operations.
* *String Methods:* The POCA String API provides a comprehensive suite
of functions for string manipulation:
** *Inspection & Measurement:* `+countCodePoints+`, `+countCodeUnits+`,
and `+length+` return measurements of the string.
** *Conversion:* `+toNumber+` and `+toString+` convert the string
between different representations.
** *Search & Extraction:* `+includes+`, `+indexOf+`, `+lastIndexOf+`,
`+split+`, `+trim+`, `+trimLeft+`, `+trimRight+`, `+substr+`, and
`+charAt+` allow searching and extracting parts of the string.
** *Code Unit/Point Operations:* `+codePointAt+`, `+codeUnitAt+`,
`+codePointToCodeUnit+`, `+codeUnitToCodePoint+`, `+codePoints+`, and
`+codeUnits+` facilitate Unicode-related operations.
** *Modification:* `+concat+` and `+repeat+` support combining and
repeating strings.
** *Case Conversion:* `+toLowerCase+` and `+toUpperCase+` change the
case of the string.
** *Encoding Conversions:* `+toLatin1+`, `+isLatin1+`, `+toUTF8+`, and
`+isUTF8+` handle encoding transformations.
** *Utility & Creation:* `+dump+`, `+fromCodePoints+`, and
`+fromCodeUnits+` provide utility functions and alternate ways to create
strings.
* *Usage:* The POCA String API offers robust text manipulation
capabilities similar to those in JavaScript. Whether you create strings
using literal syntax or factory functions, this comprehensive API lets
you incorporate advanced text processing into your POCA projects in a
dynamic, typeless environment.
* *Note:* The String API is designed to be flexible and powerful,
allowing you to work with strings in a way that suits your needs. The
API is consistent and easy to use, making it a valuable tool for
string manipulation in POCA.

== Thread

=== Overview

The POCA Thread API allows you to execute functions concurrently in
separate threads. Threads in POCA are dynamic, typeless ghost objects
that encapsulate a separate OS thread running a POCA function. With this
API you can create new threads, resume or suspend their execution,
terminate them, check their status, and wait for them to finish.

'''''

=== Global Thread Object

The global *Thread* object serves as both a factory and a namespace for
thread operations. It provides functions to create and manage threads
within your POCA scripts.

==== Thread.create

*Usage:*

[source,js]
----
let th = Thread.create(function(a, b) {
  // Thread body: perform work with a and b.
  puts("Thread started with: " + a + ", " + b);
  // ... execute thread tasks ...
  return "Thread finished";
}, arg1, arg2);
----

* *Description:* `+Thread.create+` creates a new thread ghost object
with the the provided function. The first argument must be a function; 
any additional arguments will be passed to that function when the thread
starts. Internally, a new execution context is created, and the thread
ghost object is registered in the global thread hash.
* *Parameters:*
** `+func+` (function): The function to execute in the thread.
** `+...args+` (any): Additional arguments that will be passed to the
thread function.
* *Return Value:* A thread ghost object that encapsulates the newly
created thread.
* *Example:*
+
[source,js]
----
// Create a thread that accepts two arguments.
let th = Thread.create(function(a, b) {
  puts("Started with: " + a + " and " + b);
  // Perform thread-specific work...
  return "Done";
}, "foo", "bar");
----

'''''

=== Methods on Thread Ghost Objects

Once created, a thread ghost object provides the following methods:

==== Thread.resume

_(Alias: Thread.start)_

*Usage:*

[source,js]
----
th.resume(value);
----

* *Description:* Resumes the execution of a suspended thread. If the
thread has not yet started, this signals its start semaphore to begin
execution. Optionally, a value can be passed to the thread; this value
will be available within the thread upon resumption.
* *Parameters:*
** `+value+` (any): The value to pass to the thread on resume. If
omitted, a null value is used.
* *Return Value:* The thread ghost object itself.
* *Example:*
+
[source,js]
----
// Resume the thread, passing "continue" as the resume value.
th.resume("continue");
----

'''''

==== Thread.suspend

*Usage:*

[source,js]
----
th.suspend();
----

* *Description:* Suspends the execution of a running thread. On Windows
systems, this is typically achieved by calling the appropriate system
function to suspend the thread.
* *Parameters:* None.
* *Return Value:* The thread ghost object itself.
* *Example:*
+
[source,js]
----
// Suspend the thread.
th.suspend();
----

'''''

==== Thread.kill

_(Alias: Thread.stop)_

*Usage:*

[source,js]
----
th.kill();
----

or

[source,js]
----
th.stop();
----

* *Description:* Terminates the thread forcibly. This function calls the
underlying system routine (e.g., `+KillThread+` or `+TerminateThread+`)
to stop the thread, marks the thread as terminated, and cleans up its
resources.
* *Parameters:* None.
* *Return Value:* The thread ghost object itself.
* *Example:*
+
[source,js]
----
// Terminate the thread.
th.kill();
----

'''''

==== Thread.terminated

*Usage:*

[source,js]
----
let status = th.terminated();
----

* *Description:* Checks whether the thread has been terminated.
* *Parameters:* None.
* *Return Value:* A numeric boolean value: `+1+` if the thread is
terminated, `+0+` otherwise.
* *Example:*
+
[source,js]
----
if (th.terminated()) {
  puts("Thread has terminated.");
}
----

'''''

==== Thread.wait

*Usage:*

[source,js]
----
let finished = th.wait(timeout);
----

* *Description:* Waits for the thread to terminate. If a timeout (in
milliseconds) is provided, the function waits for that duration;
otherwise, it waits indefinitely. After waiting, it returns whether the
thread has terminated.
* *Parameters:*
** `+timeout+` (number): The maximum number of milliseconds to wait. If
omitted, waits indefinitely.
* *Return Value:* A numeric boolean value: `+1+` if the thread
terminated, or `+0+` if the timeout expired and the thread is still
running.
* *Example:*
+
[source,js]
----
// Wait indefinitely for the thread to terminate.
if (th.wait()) {
  puts("Thread has terminated.");
}

// Wait up to 1000 milliseconds.
if (th.wait(1000)) {
  puts("Thread terminated within 1 second.");
}
----

'''''

=== Summary

* *Global Object:* The Thread object acts as a factory for creating
thread ghost objects. The Thread.create function creates a thread 
ghost object with a POCA function, registering it for execution
management.
* *Thread Ghost Object Methods:* Once created, thread ghost objects
provide the following methods to manage their execution:
** *resume (start):* Begins or resumes thread execution.
** *suspend:* Suspends the thread.
** *kill (stop):* Terminates the thread.
** *terminated:* Checks if the thread has finished executing.
** *wait:* Waits for the thread to complete, optionally with a timeout.
* *Usage:* Threads enable concurrent execution in POCA. They run in
their own execution context and manage their own arguments, state, and
resource cleanup. This API allows you to offload work from the main
thread and manage asynchronous operations in a dynamic, typeless
environment.

This comprehensive API lets you incorporate multithreading into your
POCA projects, providing flexible control over concurrent execution.
